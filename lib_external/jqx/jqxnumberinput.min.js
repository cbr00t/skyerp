!function(x){x.jqx.jqxWidget("jqxNumberInput","",{}),x.extend(x.jqx._jqxNumberInput.prototype,{defineInstance:function(){var t={value:0,decimal:0,min:-99999999,max:99999999,width:200,validationMessage:"Invalid value",height:25,textAlign:"right",readOnly:!1,promptChar:"_",decimalDigits:2,decimalSeparator:".",groupSeparator:",",groupSize:3,symbol:"",symbolPosition:"left",digits:8,negative:!1,negativeSymbol:"-",disabled:!1,inputMode:"advanced",spinButtons:!1,spinButtonsWidth:18,spinButtonsStep:1,autoValidate:!0,spinMode:"advanced",enableMouseWheel:!0,touchMode:"auto",allowNull:!0,placeHolder:"",changeType:null,template:"",rtl:!1,hint:!0,events:["valueChanged","textchanged","mousedown","mouseup","keydown","keyup","keypress","change"],aria:{"aria-valuenow":{name:"decimal",type:"number"},"aria-valuemin":{name:"min",type:"number"},"aria-valuemax":{name:"max",type:"number"},"aria-disabled":{name:"disabled",type:"boolean"}},invalidArgumentExceptions:["invalid argument exception"]};return this===x.jqx._jqxNumberInput.prototype||x.extend(!0,this,t),t},createInstance:function(t){""===this.promptChar&&(this.promptChar=" ");var e=this.host.attr("value");null!=e&&(this.decimal=e),0===this.decimal&&(null!=this.value?this.decimal=this.value:null===this.value&&0!==this.decimal&&(this.value=this.decimal));this._createFromInput("jqxNumberInput"),this.render()},_updateHint:function(){var t=this;t.hint&&t.isMaterialized()&&setTimeout(function(){0===t.numberInput[0].value.length?(t.element.removeAttribute("hint"),t.label&&t.label[0]&&(t.label[0].innerHTML=t.placeHolder)):t.element.setAttribute("hint",!0)})},_createFromInput:function(t){var e,i,s=this;"input"==s.element.nodeName.toLowerCase()&&(s.field=s.element,s.field.className&&(s._className=s.field.className),e={title:s.field.title},s.field.value&&(s.decimal=parseFloat(s.field.value)),s.field.getAttribute("min")&&(i=s.field.getAttribute("min"),s.min=parseFloat(i)),s.field.getAttribute("step")&&(i=s.field.getAttribute("step"),s.spinButtonsStep=parseFloat(i)),s.field.getAttribute("max")&&(i=s.field.getAttribute("max"),s.max=parseFloat(i)),s.field.id.length?e.id=s.field.id.replace(/[^\w]/g,"_")+"_"+t:e.id=x.jqx.utilities.createId()+"_"+t,(i=x("<div></div>",e))[0].style.cssText=s.field.style.cssText,s.width||(s.width=x(s.field).width()),s.height||(s.height=x(s.field).outerHeight()),x(s.field).hide().after(i),t=s.host.data(),s.host=i,s.host.data(t),s.element=i[0],s.element.id=s.field.id,s.field.id=e.id,s._className&&(s.host.addClass(s._className),x(s.field).removeClass(s._className)),s.field.tabIndex&&(t=s.field.tabIndex,s.field.tabIndex=-1,s.element.tabIndex=t))},_doTouchHandling:function(){var t=this,e=t.savedValue;if(t.parsing||(t.parsing=!0),t.parsing){t.numberInput.val()&&0==t.numberInput.val().indexOf("-")?t.setvalue("negative",!0):t.setvalue("negative",!1);for(var i=t.numberInput.val(),s=0;s<i.length-1;s++){var a=i.substring(s,s+1);if(isNaN(parseFloat(a))&&-1===t.symbol.toString().indexOf(a)&&"%"!=a&&"$"!=a&&"."!=a&&","!=a&&"-"!=a)return t.numberInput[0].value=e,void(t.parsing=!1)}t.ValueString=t.GetValueString(t.numberInput.val(),t.decimalSeparator,""!=t.decimalSeparator),t._parseDecimalInSimpleMode(),t.decimal=t.ValueString,t.getvalue("negative")&&(t.decimal="-"+t.ValueString),t.parsing=!1}},render:function(){this.host.attr({role:"spinbutton"}),this.host.attr("data-role","input"),x.jqx.aria(this),x.jqx.aria(this,"aria-multiline",!1);var t=this,e=((this.officeMode||this.theme&&-1!=this.theme.indexOf("office"))&&18==this.spinButtonsWidth&&(this.spinButtonsWidth=15),!x.jqx.mobile.isTouchDevice()&&!0!==this.touchMode||(this.inputMode="textbox",this.spinMode="simple"),""==this.decimalSeparator&&(this.decimalSeparator=" "),this.host.addClass(this.toThemeProperty("jqx-input")),this.host.addClass(this.toThemeProperty("jqx-rc-all")),this.host.addClass(this.toThemeProperty("jqx-widget")),this.host.addClass(this.toThemeProperty("jqx-widget-content")),this.host.addClass(this.toThemeProperty("jqx-numberinput")),this.spinButtons?this._spinButtons():(this.numberInput=x("<input style='border:none;' autocomplete='off' type='textarea'/>").appendTo(this.host),this.numberInput.addClass(this.toThemeProperty("jqx-input-content")),this.numberInput.addClass(this.toThemeProperty("jqx-widget-content"))),!x.jqx.mobile.isTouchDevice()&&!0!==this.touchMode||this.numberInput.attr("inputmode","numeric"),this.isMaterialized()||this.numberInput.attr("placeholder",this.placeHolder),this.host.attr("name"));e&&this.numberInput.attr("name",e),this.host.attr("tabindex")&&(this.numberInput.attr("tabindex",this.host.attr("tabindex")),this.host.removeAttr("tabindex")),!x.jqx.mobile.isTouchDevice()&&!0!==this.touchMode&&"textbox"!=this.inputMode||((t=this).savedValue="",this.addHandler(this.numberInput,"focus",function(){t.savedValue=t.numberInput[0].value}),this.addHandler(this.numberInput,"change",function(){t._doTouchHandling()}));var t=x.data(this.host[0],"jqxNumberInput").jqxNumberInput=this,a=(0<this.host.parents("form").length&&this.addHandler(this.host.parents("form"),"reset",function(){setTimeout(function(){t.setDecimal(0)},10)}),this.propertyChangeMap.disabled=function(t,e,i,s){s?(t.numberInput.addClass(a.toThemeProperty("jqx-input-disabled")),t.numberInput.attr("disabled",!0)):(t.host.removeClass(a.toThemeProperty("jqx-input-disabled")),t.numberInput.attr("disabled",!1)),t.spinButtons&&t.host.jqxRepeatButton&&(t.upbutton.jqxRepeatButton({disabled:s}),t.downbutton.jqxRepeatButton({disabled:s}))},this.disabled&&(this.numberInput.addClass(this.toThemeProperty("jqx-input-disabled")),this.numberInput.attr("disabled",!0),this.host.addClass(this.toThemeProperty("jqx-fill-state-disabled"))),this.selectedText="",this.decimalSeparatorPosition=-1,this.element.id,this.element,this),e=(this.oldValue=this._value(),this.items=new Array,this.value),i=this.decimal,t=(this._initializeLiterals(),this._render(),this.setDecimal(null!==e?i:null),this);setTimeout(function(){},100),this._addHandlers(),x.jqx.utilities.resize(this.host,function(){t._render()})},refresh:function(t){t||this._render()},wheel:function(t,e){if(e.enableMouseWheel){e.changeType="mouse";var i=0;if((t=t||window.event).originalEvent&&t.originalEvent.wheelDelta&&(t.wheelDelta=t.originalEvent.wheelDelta),t.wheelDelta?i=t.wheelDelta/120:t.detail&&(i=-t.detail/3),i)return e=e._handleDelta(i),t.preventDefault&&t.preventDefault(),null!=t.originalEvent&&(t.originalEvent.mouseHandled=!0),null!=t.stopPropagation&&t.stopPropagation(),!!e&&(t.returnValue=e=!1);t.preventDefault&&t.preventDefault(),t.returnValue=!1}},_handleDelta:function(t){return t<0?this.spinDown():this.spinUp(),!0},_addHandlers:function(){var s=this,i=(this.addHandler(this.numberInput,"paste",function(t){var e,i=s._selection();t.preventDefault(),t.originalEvent.clipboardData?e=(t.originalEvent||t).clipboardData.getData("text/plain"):window.clipboardData&&(e=window.clipboardData.getData("Text")),this.selectedText=e,x.data(document.body,"jqxSelection",this.selectedText),"simple"!=s.inputMode?s._pasteSelectedText():s.val(e),setTimeout(function(){s._setSelectionStart(i.start)})}),this.addHandler(this.numberInput,"mousedown",function(t){return s._raiseEvent(2,t)}),this._mousewheelfunc=this._mousewheelfunc||function(t){if(!s.editcell)return s.wheel(t,s),!1},this.removeHandler(this.host,"mousewheel",this._mousewheelfunc),this.addHandler(this.host,"mousewheel",this._mousewheelfunc),"");this.addHandler(this.numberInput,"focus",function(t){x.data(s.numberInput,"selectionstart",s._selection().start),s.host.addClass(s.toThemeProperty("jqx-fill-state-focus")),s.spincontainer&&s.spincontainer.addClass(s.toThemeProperty("jqx-numberinput-focus")),i=s.numberInput.val(),s._savedValue=s.decimal}),this.addHandler(this.numberInput,"blur",function(t){var e;return"simple"==s.inputMode&&s._exitSimpleInputMode(t,s,!1,i),s.autoValidate&&(e=parseFloat(s.decimal),(e=s.getvalue("negative")&&0<s.decimal?-parseFloat(s.decimal):e)>s.max&&(s._disableSetSelection=!0,s.setDecimal(s.max),s._disableSetSelection=!1),e<s.min&&(s._disableSetSelection=!0,s.setDecimal(s.min),s._disableSetSelection=!1)),s.host.removeClass(s.toThemeProperty("jqx-fill-state-focus")),s.spincontainer&&s.spincontainer.removeClass(s.toThemeProperty("jqx-numberinput-focus")),s.numberInput.val()!=i&&(s._raiseEvent(7,t),x.jqx.aria(s,"aria-valuenow",s.decimal),s.element.value=s.decimal),!0}),this.addHandler(this.numberInput,"mouseup",function(t){return s._raiseEvent(3,t)}),this.addHandler(this.numberInput,"keydown",function(t){return s.changeType="keyboard",s._raiseEvent(4,t)}),this.addHandler(this.numberInput,"keyup",function(t){return s._raiseEvent(5,t)}),this.addHandler(this.numberInput,"keypress",function(t){return s._raiseEvent(6,t)})},focus:function(){try{this.numberInput.focus()}catch(t){}},_removeHandlers:function(){this.removeHandler(this.numberInput,"mousedown"),x.jqx.mobile.isOperaMiniMobileBrowser()&&this.removeHandler(x(document),"click."+this.element.id,this._exitSimpleInputMode,this),this.removeHandler(this.numberInput,"paste"),this.removeHandler(this.numberInput,"focus"),this.removeHandler(this.numberInput,"blur"),this.removeHandler(this.numberInput,"mouseup"),this.removeHandler(this.numberInput,"keydown"),this.removeHandler(this.numberInput,"keyup"),this.removeHandler(this.numberInput,"keypress")},_spinButtons:function(){if(!this.host.jqxRepeatButton)throw new Error("jqxNumberInput: Missing reference to jqxbuttons.js.");this.numberInput?this.numberInput.css("float","left"):(this.numberInput=x("<input autocomplete='off' style='border: none; position: relative; float: left;' type='textarea'/>"),this.numberInput.appendTo(this.host),this.numberInput.addClass(this.toThemeProperty("jqx-input-content")),this.numberInput.addClass(this.toThemeProperty("jqx-widget-content"))),this.spincontainer&&(this.upbutton&&this.upbutton.jqxRepeatButton("destroy"),this.downbutton&&this.downbutton.jqxRepeatButton("destroy"),this.spincontainer.remove()),this.spincontainer=x('<div style="float: right; height: 100%; overflow: hidden; position: relative;"></div>'),this.rtl&&(this.spincontainer.css("float","right"),this.numberInput.css("float","right"),this.spincontainer.css("left","-1px")),this.host.append(this.spincontainer),this.upbutton=x('<div style="overflow: hidden; padding: 0px; margin-left: -1px; position: relative;"><div></div></div>'),this.spincontainer.append(this.upbutton),this.upbutton.jqxRepeatButton({overrideTheme:!0,disabled:this.disabled,roundedCorners:"top-right"}),this.downbutton=x('<div style="overflow: hidden; padding: 0px; margin-left: -1px; position: relative;"><div></div></div>'),this.spincontainer.append(this.downbutton),this.downbutton.jqxRepeatButton({overrideTheme:!0,disabled:this.disabled,roundedCorners:"bottom-right"}),this.template&&(this.upbutton.addClass(this.toThemeProperty("jqx-"+this.template)),this.downbutton.addClass(this.toThemeProperty("jqx-"+this.template)));var e=this,e=(this.downbutton.addClass(this.toThemeProperty("jqx-fill-state-normal jqx-action-button")),this.upbutton.addClass(this.toThemeProperty("jqx-fill-state-normal jqx-action-button")),this.upbutton.addClass(this.toThemeProperty("jqx-rc-tr")),this.downbutton.addClass(this.toThemeProperty("jqx-rc-br")),this.addHandler(this.downbutton,"mouseup",function(t){e.disabled||(e.downbutton.removeClass(e.toThemeProperty("jqx-fill-state-pressed")),e._downArrow.removeClass(e.toThemeProperty("jqx-icon-arrow-down-selected")))}),this.addHandler(this.upbutton,"mouseup",function(t){e.disabled||(e.upbutton.removeClass(e.toThemeProperty("jqx-fill-state-pressed")),e._upArrow.removeClass(e.toThemeProperty("jqx-icon-arrow-up-selected")))}),this.removeHandler(x(document),"mouseup."+this.element.id),this.addHandler(x(document),"mouseup."+this.element.id,function(t){e.upbutton.removeClass(e.toThemeProperty("jqx-fill-state-pressed")),e._upArrow.removeClass(e.toThemeProperty("jqx-icon-arrow-up-selected")),e.downbutton.removeClass(e.toThemeProperty("jqx-fill-state-pressed")),e._downArrow.removeClass(e.toThemeProperty("jqx-icon-arrow-down-selected"))}),this.addHandler(this.downbutton,"mousedown",function(t){if(!e.disabled)return x.jqx.browser.msie&&x.jqx.browser.version<9&&(e._inputSelection=e._selection()),e.downbutton.addClass(e.toThemeProperty("jqx-fill-state-pressed")),e._downArrow.addClass(e.toThemeProperty("jqx-icon-arrow-down-selected")),t.preventDefault(),t.stopPropagation(),!1}),this.addHandler(this.upbutton,"mousedown",function(t){if(!e.disabled)return x.jqx.browser.msie&&x.jqx.browser.version<9&&(e._inputSelection=e._selection()),e.upbutton.addClass(e.toThemeProperty("jqx-fill-state-pressed")),e._upArrow.addClass(e.toThemeProperty("jqx-icon-arrow-up-selected")),t.preventDefault(),t.stopPropagation(),!1}),this.addHandler(this.upbutton,"mouseenter",function(t){e.upbutton.addClass(e.toThemeProperty("jqx-fill-state-hover")),e._upArrow.addClass(e.toThemeProperty("jqx-icon-arrow-up-hover"))}),this.addHandler(this.upbutton,"mouseleave",function(t){e.upbutton.removeClass(e.toThemeProperty("jqx-fill-state-hover")),e._upArrow.removeClass(e.toThemeProperty("jqx-icon-arrow-up-hover"))}),this.addHandler(this.downbutton,"mouseenter",function(t){e.downbutton.addClass(e.toThemeProperty("jqx-fill-state-hover")),e._downArrow.addClass(e.toThemeProperty("jqx-icon-arrow-down-hover"))}),this.addHandler(this.downbutton,"mouseleave",function(t){e.downbutton.removeClass(e.toThemeProperty("jqx-fill-state-hover")),e._downArrow.removeClass(e.toThemeProperty("jqx-icon-arrow-down-hover"))}),this.upbutton.css("border-width","0px"),this.downbutton.css("border-width","0px"),this.disabled?(this.upbutton[0].disabled=!0,this.downbutton[0].disabled=!0):(this.upbutton[0].disabled=!1,this.downbutton[0].disabled=!1),this.spincontainer.addClass(this.toThemeProperty("jqx-input")),this.spincontainer.addClass(this.toThemeProperty("jqx-rc-r")),this.spincontainer.css("border-width","0px"),this.rtl?this.spincontainer.css("border-right-width","1px"):this.spincontainer.css("border-left-width","1px"),this._upArrow=this.upbutton.find("div"),this._downArrow=this.downbutton.find("div"),this._upArrow.addClass(this.toThemeProperty("jqx-icon-arrow-up")),this._downArrow.addClass(this.toThemeProperty("jqx-icon-arrow-down")),this._upArrow.addClass(this.toThemeProperty("jqx-input-icon")),this._downArrow.addClass(this.toThemeProperty("jqx-input-icon")),this),i=(this._upArrow.hover(function(){e.disabled||e._upArrow.addClass(e.toThemeProperty("jqx-icon-arrow-up-hover"))},function(){e._upArrow.removeClass(e.toThemeProperty("jqx-icon-arrow-up-hover"))}),this._downArrow.hover(function(){e.disabled||e._downArrow.addClass(e.toThemeProperty("jqx-icon-arrow-down-hover"))},function(){e._downArrow.removeClass(e.toThemeProperty("jqx-icon-arrow-down-hover"))}),x.jqx.mobile.isTouchDevice()),t="click";i&&(t=x.jqx.mobile.getTouchEventName("touchstart")),i&&(this.addHandler(this.downbutton,"click",function(t){e.spinDown()}),this.addHandler(this.upbutton,"click",function(t){e.spinUp()})),this.addHandler(this.downbutton,t,function(t){return i?(t.preventDefault(),t.stopPropagation()):(0==e._selection().start&&e._setSelectionStart(e.numberInput.val().length),x.jqx.browser.msie&&x.jqx.browser.version<9&&e._setSelectionStart(e._inputSelection.start)),e.spinDown(),!1}),this.addHandler(this.upbutton,t,function(t){return i?(t.preventDefault(),t.stopPropagation()):(0==e._selection().start&&e._setSelectionStart(e.numberInput.val().length),x.jqx.browser.msie&&x.jqx.browser.version<9&&e._setSelectionStart(e._inputSelection.start)),e.spinUp(),!1})},spinDown:function(){var t=this,e=this.decimal;if("none"!=t.spinMode)if(null==this.decimal)this.setDecimal(0);else{var i=(m=this.getvalue("negative"))?-1:0;if(!x.jqx.mobile.isTouchDevice()&&"textbox"!=this.inputMode||t._doTouchHandling(),!t.disabled){var s=this._selection(),a=this.decimal;if((u=this.getDecimal())<this.min)return u=this.min,this.setDecimal(this.min),this._setSelectionStart(s.start),void this.spinDown();if(u>this.max)return u=this.max,this.setDecimal(this.max),this._setSelectionStart(s.start),void this.spinDown();t.spinButtonsStep<0&&(t.spinButtonsStep=1);var r=i+(parseInt(t.decimal)-t.spinButtonsStep).toString().length<=t.digits+t.decimalDigits;if("advanced"!=t.spinMode||0===t.decimalDigits){if(u-t.spinButtonsStep>=t.min&&r){for(var n=1,o=0;o<t.decimalDigits;o++)n*=10;var l=n*u-n*t.spinButtonsStep;l=this._parseDecimalValueToEditorValue(l/=n),t.setDecimal(l)}}else{var h=this._getspindecimal(),u=(this._getSeparatorPosition(),parseFloat(h.decimal));t.spinButtonsStep<0&&(t.spinButtonsStep=1);r=i+(parseInt(u)-t.spinButtonsStep).toString().length<=t.digits,n=1;if(-1!=(c=h.decimal.indexOf("."))){for(var d=h.decimal.length-c-1,n=1,o=0;o<d;o++)n*=10;var c,p=(u=-1==(u=(u-=new Number(t.spinButtonsStep/n)).toFixed(d)).toString().indexOf(".")?u.toString()+".":u).toString()+h.afterdecimal;(p=(p=new Number(p)).toFixed(t.decimalDigits))>=t.min&&(p=this._parseDecimalValueToEditorValue(p),t.setDecimal(p))}else u-t.spinButtonsStep>=t.min&&r&&(l=n*u-n*t.spinButtonsStep,(p=(l/=n).toString()+h.afterdecimal)>=t.min&&(p=this._parseDecimalValueToEditorValue(p),t.setDecimal(p)))}if(null==p||"simple"!=this.inputMode)return m=this.getvalue("negative"),0==i&&m?this._setSelectionStart(s.start+1):this._setSelectionStart(s.start),t.savedValue=t.numberInput[0].value,e!=this.decimal&&(x.jqx.mobile.isTouchDevice()&&this._raiseEvent(0,{}),this._raiseEvent(7,{})),void x.jqx.aria(this,"aria-valuenow",this.decimal);p=this.decimal.toString();var m=this.getvalue("negative");0==i&&m?this._setSelectionStart(s.start+1):null==p||null!=a&&a.toString().length!=p.length?m?this._setSelectionStart(s.start+1):this._setSelectionStart(s.start-1):this._setSelectionStart(s.start),e!=this.decimal&&(x.jqx.mobile.isTouchDevice()&&this._raiseEvent(0,{}),this._raiseEvent(7,{})),x.jqx.aria(this,"aria-valuenow",this.decimal)}}},_getspindecimal:function(){var t=this._selection(),e="",i=(this._getSeparatorPosition(),this._getVisibleItems()),s=this._getHiddenPrefixCount(),a=this.numberInput.val(),r=(this.numberInput.val().length==t.start&&0==t.length&&(this._setSelection(t.start,t.start+1),t=this._selection()),"advanced"!=this.inputMode),n=t.start;0===n&&n++,1===n&&"left"===this.symbolPosition&&""!==this.symbol&&(n+=this.symbol.length);for(var o=0;o<n;o++)r?(l=a.substring(o,o+1),!isNaN(parseInt(l))&&(e+=l),l==this.decimalSeparator&&(e+=l)):i[o].canEdit&&i[o].character!=this.promptChar?e+=i[o].character:i[o].canEdit||-1==this.decimalSeparatorPosition||i[o]!=i[this.decimalSeparatorPosition-s]||(0==e.length&&(e="0"),e+=i[o].character);for(var l,h="",o=n;o<i.length;o++)r?(l=a.substring(o,o+1),isNaN(parseInt(l))||(h+=l),l==this.decimalSeparator&&(h+=l)):(i[o].canEdit&&i[o].character!=this.promptChar||!i[o].canEdit&&-1!=this.decimalSeparatorPosition&&i[o]==i[this.decimalSeparatorPosition-s])&&(h+=i[o].character);return{decimal:this.getvalue("negative")?"-"+this._parseDecimalValue(e).toString():this._parseDecimalValue(e).toString(),afterdecimal:this._parseDecimalValue(h)}},_parseDecimalValue:function(t){if("."!=this.decimalSeparator){var e=t.toString().indexOf(this.decimalSeparator);if(0<=e)return t.toString().substring(0,e)+"."+t.toString().substring(e+1)}return t},_parseDecimalValueToEditorValue:function(t){if("."!=this.decimalSeparator){var e=t.toString().indexOf(".");if(0<=e)return t.toString().substring(0,e)+this.decimalSeparator+t.toString().substring(e+1)}return t},spinUp:function(){var t=this,e=this.decimal;if("none"!=t.spinMode)if(null==this.decimal)this.setDecimal(0);else{!x.jqx.mobile.isTouchDevice()&&"textbox"!=this.inputMode||t._doTouchHandling();var i=(m=this.getvalue("negative"))?-1:0;if(!t.disabled){var s=this._selection(),a=t.decimal;if((u=t.getDecimal())<this.min)return u=this.min,this.setDecimal(this.min),this._setSelectionStart(s.start),void this.spinUp();if(u>this.max)return u=this.max,this.setDecimal(this.max),this._setSelectionStart(s.start),void this.spinUp();t.spinButtonsStep<0&&(t.spinButtonsStep=1);var r=i+(parseInt(t.decimal)+t.spinButtonsStep).toString().length<=t.digits+t.decimalDigits;if("advanced"!=t.spinMode||0===t.decimalDigits){if(u+t.spinButtonsStep<=t.max&&r){for(var n=1,o=0;o<t.decimalDigits;o++)n*=10;var l=n*u+n*t.spinButtonsStep;l=this._parseDecimalValueToEditorValue(l/=n),t.setDecimal(l)}}else{var h=this._getspindecimal(),u=(this._getSeparatorPosition(),parseFloat(h.decimal));t.spinButtonsStep<0&&(t.spinButtonsStep=1);r=i+(parseInt(u)+t.spinButtonsStep).toString().length<=t.digits,n=1;if(-1!=(c=h.decimal.indexOf("."))){for(var d=h.decimal.length-c-1,n=1,o=0;o<d;o++)n*=10;var c,p=(u=-1==(u=(u+=new Number(t.spinButtonsStep/n)).toFixed(d)).toString().indexOf(".")?u.toString()+".":u).toString()+h.afterdecimal;p=(p=new Number(p)).toFixed(t.decimalDigits),new Number(p).toFixed(t.decimalDigits)<=t.max?(p=this._parseDecimalValueToEditorValue(p),t.setDecimal(p)):p=void 0}else u+t.spinButtonsStep<=t.max&&r&&(l=n*u+n*t.spinButtonsStep,p=(l/=n).toString()+h.afterdecimal,new Number(p).toFixed(t.decimalDigits)<=t.max?(p=this._parseDecimalValueToEditorValue(p),m&&-1==p.indexOf("-")&&"-0"!=h.decimal&&(p="-"+p),t.setDecimal(p)):p=void 0)}if(null==p||"simple"!=this.inputMode)return this._setSelectionStart(s.start),t.savedValue=t.numberInput[0].value,e!=this.decimal&&(x.jqx.mobile.isTouchDevice()&&this._raiseEvent(0,{}),this._raiseEvent(7,{})),void x.jqx.aria(this,"aria-valuenow",this.decimal);p=this.decimal.toString();var m=this.getvalue("negative");-1!=i||m?null!=p&&(null==a||a.toString().length==p.length)||m?this._setSelectionStart(s.start):this._setSelectionStart(1+s.start):this._setSelectionStart(-1+s.start),e!=this.decimal&&(x.jqx.mobile.isTouchDevice()&&this._raiseEvent(0,{}),this._raiseEvent(7,{})),x.jqx.aria(this,"aria-valuenow",this.decimal)}}},_exitSimpleInputMode:function(t,e,i,s){if(null!=(e=null==e?t.data:e)){if(null==i){if(null!=t.target&&null!=e.element&&(null!=t.target.id&&0<t.target.id.toString().length&&0<e.host.find("#"+t.target.id).length||t.target==e.element))return;var i=e.host.offset(),a=i.left,i=i.top,r=e.host.width(),n=e.host.height(),t=x(t.target).offset();if(t.left>=a&&t.left<=a+r&&t.top>=i&&t.top<=i+n)return}if(x.jqx.mobile.isOperaMiniBrowser()&&e.numberInput.attr("readonly",!0),!e.disabled&&!e.readOnly){a=x.data(e.numberInput,"simpleInputMode");if(null!=a)return x.data(e.numberInput,"simpleInputMode",null),this._parseDecimalInSimpleMode(),!1}}},_getDecimalInSimpleMode:function(){var t,e=this.decimal;return e="."!=this.decimalSeparator&&0<(t=e.toString().indexOf(this.decimalSeparator))?e.toString().substring(0,t)+"."+e.toString().substring(t+1):e},_parseDecimalInSimpleMode:function(t){var e=this.getvalue("negative"),i=this.ValueString,s=(null==i&&(i=this.GetValueString(this.numberInput.val(),this.decimalSeparator,""!=this.decimalSeparator)),"."==this.decimalSeparator||0<(s=i.toString().indexOf("."))&&(i=i.toString().substring(0,s)+this.decimalSeparator+i.toString().substring(s+1)),e?"-":"");"left"==this.symbolPosition&&(s+=this.symbol);0==this.digits%this.groupSize&&this.groupSize;e=i.toString();s+=e=0<=e.indexOf("-")?e.substring(e.indexOf("-")+1):e,"right"==this.symbolPosition&&(s+=this.symbol),0!=t&&this.numberInput.val(s)},_enterSimpleInputMode:function(t,e){null==e&&(e=t.data);var i,s,t=this._selection();null!=e&&(i=e.getvalue("negative"),s=e.decimal,e.numberInput.val(s=i&&0<s?-s:s),x.data(e.numberInput,"simpleInputMode",!0),x.jqx.mobile.isOperaMiniBrowser()&&e.numberInput.attr("readonly",!1),this._parseDecimalInSimpleMode(),this._setSelectionStart(t.start))},setvalue:function(t,e){void 0!==this[t]&&("decimal"==t?this._setDecimal(e):(this[t]=e,this.propertyChangedHandler(this,t,e,e)))},getvalue:function(t){return"decimal"==t&&null!=this.negative&&1==this.negative?this.decimal.toString().indexOf(",")?-Math.abs(this.decimal.toString().replace(/,/,".")):-Math.abs(this[t]):t in this?this[t]:null},_getString:function(){for(var t="",e=0;e<this.items.length;e++)t+=this.items[e].character;return t},_literal:function(t,e,i,s){return{character:t,regex:e,canEdit:i,isSeparator:s}},_initializeLiterals:function(){if("textbox"!=this.inputMode){for(var t=0,e=this.negativeSymbol.length,i=0;i<e;i++){var s=this.negativeSymbol.substring(i,i+1),a="",r=!1,n=null;n=this.negative?this._literal(s,a,r,!1):this._literal("",a,r,!1),this.items[t]=n,t++}var o=this.symbol.length;if("left"==this.symbolPosition)for(i=0;i<o;i++){s=this.symbol.substring(i,i+1),a="",r=!1,n=this._literal(s,a,r,!1);this.items[t]=n,t++}0==(l=this.digits%this.groupSize)&&(l=this.groupSize);for(i=0;i<this.digits;i++){var l,h,s=this.promptChar,a="\\d",r=!0,n=this._literal(s,a,r,!1);this.items[t]=n,t++,i<this.digits-1&&null!=this.groupSeparator&&0<this.groupSeparator.length?0==--l&&(l=this.groupSize,h=this._literal(this.groupSeparator,"",!1,!1),this.items[t]=h,t++):i==this.digits-1&&(n.character=0)}if(this.decimalSeparatorPosition=-1,null!=this.decimalDigits&&0<this.decimalDigits){n=(0==(s=this.decimalSeparator).length&&(s="."),this._literal(s,"",!1,!0));this.items[t]=n,this.decimalSeparatorPosition=t,t++;for(i=0;i<this.decimalDigits;i++){var a="\\d",u=this._literal(0,a,!0,!1);this.items[t]=u,t++}}if("right"==this.symbolPosition)for(i=0;i<o;i++){s=this.symbol.substring(i,i+1),a="",r=!1,n=this._literal(s,a,r);this.items[t]=n,t++}}},_match:function(t,e){return new RegExp(e,"i").test(t)},_raiseEvent:function(t,e){var i=this.events[t],s={};if("none"==(s.owner=this).host.css("display"))return!0;var a=e.charCode||e.keyCode||0,r=!0,n=this.readOnly;if((3==t||2==t)&&!this.disabled){if("simple"==this.inputMode||"textbox"==this.inputMode)return!0;this._handleMouse(e)}0==t&&(o=this.getvalue("decimal"),this.max<o||this.min>o?this.host.addClass(this.toThemeProperty("jqx-input-invalid")):(this.host.removeClass(this.toThemeProperty("jqx-input-invalid")),this.host.addClass(this.toThemeProperty("jqx-input")),this.host.addClass(this.toThemeProperty("jqx-rc-all"))));var o=new x.Event(i),i=(o.owner=this,s.value=this.getvalue("decimal"),s.text=this.numberInput.val(),o.args=s,7==t&&(s.type=this.changeType,this.changeType=null),null!=i&&4!=t&&5!=t&&6!=t&&(r=this.host.trigger(o)),this);if("textbox"==this.inputMode)return r;if("simple"!=this.inputMode){if(4==t){if(n||this.disabled)return!1;r=i._handleKeyDown(e,a)}else if(5==t)(n||this.disabled)&&(r=!1);else if(6==t){if(n||this.disabled)return!1;r=i._handleKeyPress(e,a)}}else if(4==t||5==t||6==t){if(x.jqx.mobile.isTouchDevice()||!0===this.touchMode)return!0;if(n||this.disabled)return!1;o=String.fromCharCode(a),n=(parseInt(o),!0);if(e.ctrlKey||e.shiftKey||e.metaKey||65<=a&&a<=90&&(n=!1),6==t&&null!=x.jqx.browser.opera&&8==a)return!1;if(n){4==t&&(n=i._handleSimpleKeyDown(e,a)),107==a&&(h=i.getvalue("negative"))&&(i.setvalue("negative",!1),i.decimal=i.ValueString,i._parseDecimalInSimpleMode(),i._setSelectionStart(l.start+1),i._raiseEvent(0,i.value),i._raiseEvent(1,i.numberInput.val())),189!=a&&45!=a&&109!=a&&173!=a||(l=i._selection(),4==t&&(0==(h=i.getvalue("negative"))?i.setvalue("negative",!0):i.setvalue("negative",!1),i.decimal=i.ValueString,i._parseDecimalInSimpleMode(),h?i._setSelectionStart(l.start-1):i._setSelectionStart(l.start+1),n=!1,i._raiseEvent(0,i.value),i._raiseEvent(1,i.numberInput.val())));var l,h,o=s.ctrlKey||s.metaKey;if(!x.jqx.browser.msie)if(o&&99==a||o&&67==a||o&&122==a||o&&90==a||o&&118==a||o&&86==a||e.shiftKey&&45==a)return(x.jqx.browser.webkit||x.jqx.browser.chrome)&&i._handleSimpleKeyDown(e,a),67==a;if(o&&97==a||o&&65==a)return!0;if(6==t&&n)return this._isSpecialKey(a)}return n}return r},GetSelectionInValue:function(t,e,i,s){for(var a=0,r=0;r<e.length&&!(t<=r);r++){var n=e.substring(r,r+1);(!isNaN(parseInt(n))||s&&e.substring(r,r+1)==i)&&a++}return a},GetSelectionLengthInValue:function(t,e,i,s){for(var a=0,r=0;r<i.length&&!(t+e<=r);r++){var n=i.substring(r,r+1),n=!isNaN(parseInt(n));(0<e&&t<=r&&n||t<=r&&i[r].toString()==s)&&a++}return a},GetInsertTypeByPositionInValue:function(t,e,i,s){var a="before",i=this.GetValueString(i,e,s);return a=this.GetDigitsToSeparator(0,i,e)<t?"after":a},RemoveRange:function(t,e,i,s,a,r){var n=this.digits,o=t,l=e,h=0,u=(this.decimal,this._selection(),""!=(s=this.decimalSeparator));if(0==l&&this.ValueString.length<this.decimalPossibleChars-1)return h;for(var d,c=this.GetSeparatorPositionInText(s,i),p=(-1==(c=(c=a?c:this.GetSeparatorPositionInText(s,i))<0&&!u&&1<i.length?i.length:c)&&(c=i.length),u?1:0),m=(e<2&&1==r&&this.ValueString.length-this.decimalDigits-p==n&&t+e<c&&l++,""),g=0;g<i.length;g++)g<o||o+l<=g?m+=i.substring(g,g+1):(d=i.substring(g,g+1))==s?m+=s:(d=i.substring(g,g+1),this.symbol&&""!=this.symbol&&0<=this.symbol.indexOf(d)||(c<g?m+="0":(d=i.substring(g,g+1),isNaN(parseInt(d))||h++)));0==m.length&&(m="0"),a?this.numberInput.val(m):this.ValueString=m;r=m.substring(0,1);return r==s&&isNaN(parseInt(r))&&(m="0"+m),this.ValueString=this.GetValueString(m,s,u),this.decimal=this.ValueString,this._parseDecimalInSimpleMode(),this._setSelectionStart(o),h},InsertDigit:function(t,e){"number"!=typeof this.digits&&(this.digits=parseInt(this.digits)),"number"!=typeof this.decimalDigits&&(this.decimalDigits=parseInt(this.decimalDigits));var i=1+this.digits,s=this._selection(),a=this.getvalue("negative"),r=!1,r=(0==s.start&&""!=this.symbol&&"left"==this.symbolPosition&&(this._setSelectionStart(s.start+1),s=this._selection(),r=!0),(a&&r||a&&!r&&0==s.start)&&(this._setSelectionStart(s.start+1),s=this._selection()),this.numberInput.val().substring(s.start,s.start+1)),n=this.numberInput.val(),o=this.decimalSeparator,l=""!=o&&0<this.decimalDigits;if(r==this.symbol&&"right"==this.symbolPosition){if(0!=this.decimalDigits)return;if(this.ValueString=this.GetValueString(n,o,l),this.ValueString.length>=i)return}this.ValueString=this.GetValueString(n,o,l),""==this.ValueString&&(this.ValueString=new Number(0).toFixed(this.decimalDigits));var r=this.ValueString,h="",u=((e=0<this.decimalDigits&&e>=r.length?r.length-1:e)<r.length&&(h=r.substring(e,e+1)),!1);"after"==this.GetInsertTypeByPositionInValue(e,o,n,l)&&(u=!0);h!=o&&this.ValueString.length-this.decimalDigits-(l?1:0)>=i-1&&(u=!0),"0"===h&&1===this.ValueString.length&&0===this.decimalDigits&&(u=!0);n=l?1:0;if(!(!u&&this.ValueString&&this.ValueString.length>=this.digits+this.decimalDigits+n)){if(u&&h!=o){var d=r.substring(0,e);if(d.length==r.length&&this.ValueString.length>=this.digits+this.decimalDigits+n)return;var c="",p=d+(m=t)+(c=e+1<r.length?r.substring(e+1):c);this.ValueString=p}else{var m,p=(d=r.substring(0,e))+(m=t)+(c=r.substring(e));"0"==r.substring(0,1)&&r.substring(1,2)==o&&(p=m+r.substring(1),h==o&&(this._setSelectionStart(s.start-1),s=this._selection())),this.ValueString=p}this.decimal=a?"-"+this.ValueString:this.ValueString,this._parseDecimalInSimpleMode();i=s.start;this._setSelectionStart(i+=1),this.value=this.decimal,this._raiseEvent(0,this.value),this._raiseEvent(1,this.numberInput.val())}},GetStringToSeparator:function(t,e,i){var s=this.GetSeparatorPositionInText(e,t),t=t.subString(0,s);return this.GetValueString(t,e,i)},GetSeparatorPositionInText:function(t,e){for(var i=-1,s=0;s<e.length;s++)if(e.substring(s,s+1)==t){i=s;break}return i},GetValueString:function(t,e,i){for(var s="",a=0;a<t.length;a++){var r=t.substring(a,a+1);!isNaN(parseInt(r))&&(s+=r),r==e&&(s+=e)}return s},Backspace:function(){var t=this._selection(),e=this._selection(),i=this.numberInput.val();0==t.start&&0==t.length||(this.isBackSpace=!0,i=i.substring[t.start,t.start+1],isNaN(parseInt(i)),0<t.start&&0==t.length&&(this._setSelectionStart(t.start-1),t=this._selection()),this.Delete(),this._setSelectionStart(e.start-1),this.isBackSpace=!1)},Delete:function(t){var e=this._selection(),i=this.numberInput.val(),s=(0===e.start&&"-"==i.substring(0,1)&&(this.setvalue("negative",!1),e=this._selection(),i=this.numberInput.val()),e.start),a=(0<e.start&&"-"==i.substring(0,1)&&(e.start=--s),e.length),a=Math.max(a,1),i=(this.ValueString=this.GetValueString(i,this.decimalSeparator,""!=this.decimalSeparator),s>this.ValueString.indexOf(this.decimalSeparator)&&0<this.decimalDigits&&s++,0),e=(this.symbol&&("left"==this.symbolPosition&&i--,this.negative&&i--),this.RemoveRange(e.start+i,a,this.ValueString,".",!1),this.ValueString.substring(0,1));isNaN(parseInt(e))&&(this.ValueString="0"+this.ValueString),this.decimal=this.ValueString,this._parseDecimalInSimpleMode(),this._setSelectionStart(s),this.value=this.decimal,this._raiseEvent(0,this.value),this._raiseEvent(1,this.numberInput.val())},insertsimple:function(t){var e=this._selection(),i=this.numberInput.val();if(!(e.start==i.length&&null!=this.decimal&&0<this.decimalDigits)){this.decimal;var s=this.decimalSeparator,a=(this.ValueString=this.GetValueString(i,s,""!=s),this.GetSelectionInValue(e.start,i,s,""!=s)),i=this.GetSelectionLengthInValue(e.start,e.length,i,s);this.GetDigitsToSeparator(0,this.ValueString,s);if(0<this.decimalDigits&&a>=this.ValueString.length&&a--,""==this.ValueString)return this.ValueString=new Number(0).toFixed(this.decimalDigits),this.ValueString=this.ValueString.replace(".",s),this.RemoveRange(e.start,i,this.ValueString,s,!1,!0),void this.InsertDigit(t,0,e);this.RemoveRange(e.start,i,this.ValueString,s,!1,!0),this.InsertDigit(t,a,e)}},GetDigitsToSeparator:function(t,e,i){if(e.indexOf(i=null==i?".":i)<0)return e.length;for(var s=0;s<e.length;s++)if(e.substring(s,s+1)==i){t=s;break}return t},_handleSimpleKeyDown:function(t,e){var i,s=this._selection(),a=t.ctrlKey||t.metaKey;if((8==e||46==e)&&a)return this.setDecimal(null),!1;if(0<=s.start&&s.start<this.items.length&&(d=String.fromCharCode(e)),27===e&&(this.setDecimal(this._savedValue),-1!=(i=this.GetSeparatorPositionInText(this.decimalSeparator,this.numberInput.val()))&&this._setSelectionStart(i),t.preventDefault()),this.rtl&&37==e)return p=(c=t.shiftKey)?1:0,c?this._setSelection(s.start+1-p,s.start+s.length+1):this._setSelection(s.start+1-p,s.start+1),!1;if(this.rtl&&39==e)return p=(c=t.shiftKey)?1:0,c?this._setSelection(s.start-1,s.length+p+s.start-1):this._setSelection(s.start-1,s.start-1),!1;if(8==e)return this.Backspace(),!1;if(190==e||110==e)return-1!=(i=this.GetSeparatorPositionInText(this.decimalSeparator,this.numberInput.val()))&&this._setSelectionStart(i+1),!1;if(188==e&&","===this.groupSeparator){for(var r=this.numberInput.val(),n=s.start;n<r.length;n++)if(r[n]==this.groupSeparator){this._setSelectionStart(1+n);break}return!1}if((a=t.ctrlKey||t.metaKey)&&99==e||a&&67==e){var o,s=this._selection(),l="",h=this.numberInput.val();if(0<s.start||0<s.length)for(var n=s.start;n<s.end;n++)l+=h.substring(n,n+1);return x.data(document.body,"jqxSelection",l),x.jqx.browser.msie?window.clipboardData.setData("Text",l):(u=this,(o=x('<textarea style="position: absolute; left: -1000px; top: -1000px;"/>')).val(l),x("body").append(o),o.select(),setTimeout(function(){document.designMode="off",o.select(),o.remove(),u.focus()},100)),this.savedText=l,!0}if(a&&122==e||a&&90==e)return!1;if(a&&118==e||a&&86==e||t.shiftKey&&45==e)return x.jqx.browser.msie&&!this.savedText&&(this.savedText=window.clipboardData.getData("Text")),null!=this.savedText&&0<this.savedText.length?this.val(this.savedText):this.val(x.data(document.body,"jqxSelection")),!1;var u,d=String.fromCharCode(e),c=parseInt(d);if(96<=e&&e<=105&&(c=e-96,e-=48),!isNaN(c))return(u=this).insertsimple(c),!1;if(46==e)return this.Delete(),!1;if(38==e)return this.spinUp(),!1;if(40==e)return this.spinDown(),!1;var p=this._isSpecialKey(e);return!x.jqx.browser.mozilla||p},_getEditRange:function(){for(var t=0,e=0,i=0;i<this.items.length;i++)if(this.items[i].canEdit){t=i;break}for(i=this.items.length-1;0<=i;i--)if(this.items[i].canEdit){e=i;break}return{start:t,end:e}},_getVisibleItems:function(){for(var t=new Array,e=0,i=0;i<this.items.length;i++)0<this.items[i].character.toString().length&&(t[e]=this.items[i],e++);return t},_hasEmptyVisibleItems:function(){for(var t=this._getVisibleItems(),e=0;e<t.length;e++)if(t[e].canEdit&&t[e].character==this.promptChar)return!0;return!1},_getFirstVisibleNonEmptyIndex:function(){for(var t=this._getVisibleItems(),e=0;e<t.length;e++)if(t[e].canEdit&&t[e].character!=this.promptChar)return e},_handleMouse:function(t,e){var i,s=this._selection();s.length<=1&&(i=this._getFirstVisibleNonEmptyIndex(),s.start<i&&this._setSelectionStart(i))},_insertKey:function(t){this.numberInput[0].focus();var m=String.fromCharCode(t),t=parseInt(m);if(!isNaN(t)){for(var g=0,e=0;e<this.items.length;e++)0==this.items[e].character.length&&g++;var v,b,f,S=this._selection(),_=this;0<=S.start&&S.start<=this.items.length&&(v=!1,t=this._getFirstVisibleNonEmptyIndex(),S.start<t&&0==S.length&&(isNaN(m)&&" "!=m||(this._setSelectionStart(t),S=this._selection())),this._getFirstEditableItemIndex(),b=this._getLastEditableItemIndex(),null===this.value&&(b=0),f=this._getVisibleItems(),x.each(f,function(t,e){if(!(S.start>t&&t!=f.length-1)){var i=f[t];if(b<t&&(i=f[b]),!isNaN(m)&&" "!=m&&""!=m&&i&&i.canEdit){var s=_._getSeparatorPosition();if(_._match(m,i.regex)){if(!v&&0<S.length){for(var a=S.start+g;a<S.end+g;a++)_.items[a].canEdit&&(_.items[a].character=s<a?"0":_.promptChar);var r=_._getString();v=!0}var s=_._getSeparatorPosition(),n=_._hasEmptyVisibleItems();if(null==_.decimal&&(S.start=s-1,S.start<0&&(S.start=0),S.end=S.start),S.start<=s&&n){for(var o=t,l=(-1==_.decimalSeparatorPosition&&S.start==s&&(o=t+1),null==_.decimal&&(o=S.start),""),h=0;h<o;h++)f[h].canEdit&&f[h].character!=_.promptChar&&(l+=f[h].character);l+=m;var u=_.decimal<1?1:0;S.start==s&&-1!=_.decimalSeparatorPosition&&(l+=_.decimalSeparator,u=0);for(h=o+u;h<f.length;h++)(f[h].character==_.decimalSeparator&&f[h].isSeparator||f[h].canEdit&&f[h].character!=_.promptChar)&&(l+=f[h].character);"."!=_.decimalSeparator&&(l=_._parseDecimalValue(l)),l=parseFloat(l).toString(),l=(l=new Number(l)).toFixed(_.decimalDigits),"."!=_.decimalSeparator&&(l=_._parseDecimalValueToEditorValue(l)),_.setvalue("decimal",l);var r=_._getString();S.end<s?_._setSelectionStart(S.end+u):_._setSelectionStart(S.end),1<=S.length&&_._setSelectionStart(S.end),S.length==_.numberInput.val().length&&(c=_._moveCaretToDecimalSeparator(),p=0<=_.decimalSeparatorPosition?1:0,_._setSelectionStart(c-p))}else if(S.start<s||S.start>s){if(_.numberInput.val().length==S.start&&-1!=_.decimalSeparatorPosition)return!1;if(_.numberInput.val().length==S.start&&-1==_.decimalSeparatorPosition&&!n)return!1;for(var l="",d=!1,h=0;h<t;h++)f[h].canEdit&&f[h].character!=_.promptChar&&(l+=f[h].character),f[h].character==_.decimalSeparator&&f[h].isSeparator&&(l+=f[h].character,d=!0);l+=m;u=_.decimal<1?1:0;d||S.start!=s-1||(l+=_.decimalSeparator,d=!0);for(h=t+1;h<f.length;h++)(!d&&f[h].character==_.decimalSeparator&&f[h].isSeparator||f[h].canEdit&&f[h].character!=_.promptChar)&&(l+=f[h].character);_.setvalue("decimal",l);r=_._getString();if(_.decimalSeparatorPosition<0&&i==f[b])return _._setSelectionStart(t),!1;var c,p=r.indexOf(_.symbol);p<=(_.getvalue("negative")?1:0)&&(p=r.length),S.start<p?_._setSelectionStart(t+1):_._setSelectionStart(t),S.length,S.length==_.numberInput.val().length&&(c=_._moveCaretToDecimalSeparator(),_._setSelectionStart(c-1))}return!1}}}}))}},_handleKeyPress:function(t,e){var i=this._selection(),t=t.ctrlKey||t.metaKey;return!!(t&&97==e||t&&65==e)||(8==e?(0<i.start&&this._setSelectionStart(i.start),!1):46==e?(i.start<this.items.length&&this._setSelectionStart(i.start),!1):(x.jqx.browser.mozilla||45!=e&&173!=e&&109!=e&&189!=e||(0==this.getvalue("negative")?this.setvalue("negative",!0):this.setvalue("negative",!1)),x.jqx.browser.msie&&this._insertKey(e),this._isSpecialKey(e)))},_deleteSelectedText:function(){var t=this._selection(),e="",i=this._getSeparatorPosition(),s=this._getVisibleItems(),a=this._getHiddenPrefixCount();this.numberInput.val().length==t.start&&0==t.length&&(this._setSelection(t.start,t.start+1),t=this._selection());for(var r=0;r<t.start;r++)s[r].canEdit&&s[r].character!=this.promptChar?e+=s[r].character:s[r].canEdit||-1==this.decimalSeparatorPosition||s[r]!=s[this.decimalSeparatorPosition-a]||(0==e.length&&(e="0"),e+=s[r].character);for(r=t.start;r<t.end;r++)i<r&&-1!=this.decimalSeparatorPosition?s[r].canEdit&&s[r].character!=this.promptChar&&(e+="0"):s[r].canEdit||-1==this.decimalSeparatorPosition||s[r]!=s[this.decimalSeparatorPosition-a]||(0==e.length&&(e="0"),e+=s[r].character);for(r=t.end;r<s.length;r++)s[r].canEdit&&s[r].character!=this.promptChar?e+=s[r].character:s[r].canEdit||-1==this.decimalSeparatorPosition||s[r]!=s[this.decimalSeparatorPosition-a]||(0==e.length&&(e="0"),e+=s[r].character);return this.setvalue("decimal",e),0<t.length},_restoreInitialState:function(){var t=parseInt(this.decimalDigits);0<t&&(t+=2);for(var e=this.items.length-1;e>this.items.length-1-t&&this.items[e];e--)this.items[e].canEdit&&this.items[e].character==this.promptChar&&(this.items[e].character=0)},clear:function(){this.setDecimal(0)},clearDecimal:function(){if("textbox"==this.inputMode)this.numberInput.val();else{for(var t=0;t<this.items.length;t++)this.items[t].canEdit&&(this.items[t].character=this.promptChar);this._restoreInitialState()}},_saveSelectedText:function(){var t=this._selection(),e="",i=this._getVisibleItems();if(0<t.start||0<t.length)for(var s=t.start;s<t.end;s++)(i[s].canEdit&&i[s].character!=this.promptChar||i[s].isSeparator)&&(e+=i[s].character);return x.jqx.browser.msie&&window.clipboardData.setData("Text",e),e},_pasteSelectedText:function(){var t=this._selection();if(this.selectedText=x.data(document.body,"jqxSelection"),window.clipboardData){var e=window.clipboardData.getData("Text");if(e!=this.selectedText&&0<e.length&&(this.selectedText=window.clipboardData.getData("Text"),null==this.selectedText||null==this.selectedText))return}t.start,this._getVisibleItems();if(null!=this.selectedText)for(var i=0;i<this.selectedText.length;i++){var s=parseInt(this.selectedText[i]);isNaN(s)||this._insertKey(48+s)}},_getHiddenPrefixCount:function(){var t=0;if(this.negative||t++,"left"==this.symbolPosition)for(var e=0;e<this.symbol.length;e++)""==this.symbol.substring(e,e+1)&&t++;return t},_getEditableItem:function(){for(var t=this._selection(),e=0;e<this.items.length;e++)if(e<t.start&&this.items[e].canEdit&&this.items[e].character!=this.promptChar)return this.items[e];return null},_getEditableItems:function(){for(var t=new Array,e=0,i=0;i<this.items.length;i++)this.items[i].canEdit&&(t[e]=this.items[i],e++);return t},_getValidSelectionStart:function(t){for(var e=this.items.length-1;0<=e;e--)if(this.items[e].canEdit&&this.items[e].character!=this.promptChar)return e;return-1},_getEditableItemIndex:function(t){for(var e=this._selection(),i=this._getHiddenPrefixCount(),s=this._getVisibleItems(),a=e.start,r=-1,n=0;n<a;n++)n<s.length&&s[n].canEdit&&(r=n+i);if(-1==r&&0<e.length)for(a=e.end,n=0;n<a;n++)if(n<s.length&&s[n].canEdit){r=n+i;break}return r},_getEditableItemByIndex:function(t){for(var e=0;e<this.items.length;e++)if(t<e&&this.items[e].canEdit&&this.items[e].character!=this.promptChar)return e;return-1},_getFirstEditableItemIndex:function(){for(var t=this._getVisibleItems(),e=0;e<t.length;e++)if(t[e].character!=this.promptChar&&t[e].canEdit&&"0"!=t[e].character)return e;return-1},_getLastEditableItemIndex:function(){for(var t=this._getVisibleItems(),e=t.length-1;0<=e;e--)if(t[e].character!=this.promptChar&&t[e].canEdit)return e;return-1},_moveCaretToDecimalSeparator:function(){for(var t=this.items.length-1;0<=t;t--)if(this.items[t].character==this.decimalSeparator&&this.items[t].isSeparator)return this.negative?this._setSelectionStart(t+1):this._setSelectionStart(t),t;return this.numberInput.val().length},_handleBackspace:function(){var t=this._selection(),e=this._getHiddenPrefixCount(),e=this._getEditableItemIndex()-e,i=this._getFirstVisibleNonEmptyIndex(),s=!1;this.negative&&(s=!0,(1+e<=i||0==t.start)&&(this.setvalue("negative",!1),0==t.length&&(this._setSelectionStart(t.start-1),t=this._selection()))),0<=e?(0==t.length&&-1!=e&&this._setSelection(e,1+e),(i=t.start>this._getSeparatorPosition()+1&&0<this.decimalSeparatorPosition)&&(t=this._selection()),this._deleteSelectedText(),t.length<1||i?this._setSelectionStart(t.start):1<=t.length&&this._setSelectionStart(t.end),t.length!=this.numberInput.val().length&&!s||(e=this._moveCaretToDecimalSeparator(),this._setSelectionStart(e-1),s&&this._setSelectionStart(t.start))):this._setSelectionStart(t.start)},_handleKeyDown:function(t,e){var i=this._selection(),s=t.ctrlKey||t.metaKey;if((8==e||46==e)&&s)return this.setDecimal(null),!1;if(this.rtl&&37==e)return l=(o=t.shiftKey)?1:0,o?this._setSelection(i.start+1-l,i.start+i.length+1):this._setSelection(i.start+1-l,i.start+1),!1;if(this.rtl&&39==e)return l=(o=t.shiftKey)?1:0,o?this._setSelection(i.start-1,i.length+l+i.start-1):this._setSelection(i.start-1,i.start-1),!1;if(s&&97==e||s&&65==e)return!0;if(s&&120==e||s&&88==e)return this.selectedText=this._saveSelectedText(t),x.data(document.body,"jqxSelection",this.selectedText),this._handleBackspace(),!1;if(s&&99==e||s&&67==e)return this.selectedText=this._saveSelectedText(t),x.data(document.body,"jqxSelection",this.selectedText),!1;if(s&&122==e||s&&90==e)return!1;if(s&&118==e||s&&86==e||t.shiftKey&&45==e)return this._pasteSelectedText(),!1;if(0<=i.start&&i.start<this.items.length&&(n=String.fromCharCode(e),this.items[i.start]),8==e)return this._handleBackspace(),!1;if(190==e||110==e)return this._moveCaretToDecimalSeparator(),!1;if(188===e&&","===this.decimalSeparator)return this._moveCaretToDecimalSeparator(),!1;if(188==e&&","===this.groupSeparator){for(var a=this.numberInput.val(),r=i.start;r<a.length;r++)if(a[r]==this.groupSeparator){this._setSelectionStart(1+r);break}return!1}if(null==x.jqx.browser.msie){var n=String.fromCharCode(e),o=parseInt(n);if(96<=e&&e<=105&&(o=e-96,e-=48),!isNaN(o))return this._insertKey(e),!1}if(46==e){s=this._getVisibleItems();if(i.start<s.length){var l=0==s[i.start].canEdit?2:1;if(0==i.start)if(this.negative)if(this.setvalue("negative",!1),0==i.length&&this._setSelectionStart(0),0==(i=this._selection()).length)return!1;0==i.length&&this._setSelection(i.start+l,i.start+l+i.length),this._handleBackspace(),(new Number(this.decimal)<1||i.start>this._getSeparatorPosition()||i.start+1<this.decimalSeparatorPosition)&&this._setSelectionStart(i.end+l)}return!1}if(38==e)return this.spinUp(),!1;if(40==e)return this.spinDown(),!1;27===e&&(this.setDecimal(this._savedValue),this._setSelectionStart(i.end),t.preventDefault());n=this._isSpecialKey(e);return!x.jqx.browser.mozilla||45!=e&&173!=e&&109!=e&&189!=e||(0==this.getvalue("negative")?this.setvalue("negative",!0):this.setvalue("negative",!1)),!x.jqx.browser.mozilla||n},_isSpecialKey:function(t){return 8==t||9==t||13==t||35==t||36==t||37==t||39==t||27==t||46==t},_selection:function(){try{var t;if("selectionStart"in this.numberInput[0])return a=(t=this.numberInput[0]).selectionEnd-t.selectionStart,{start:t.selectionStart,end:t.selectionEnd,length:a,text:t.value};var e=document.selection.createRange();if(null==e)return{start:0,end:t.value.length,length:0};var i=this.numberInput[0].createTextRange(),s=i.duplicate(),a=(i.moveToBookmark(e.getBookmark()),s.setEndPoint("EndToStart",i),e.text.length);return{start:s.text.length,end:s.text.length+e.text.length,length:a,text:e.text}}catch(t){return{start:0,end:0,length:0}}},selectAll:function(){var e=this.numberInput;setTimeout(function(){var t;"selectionStart"in e[0]?(e[0].focus(),e[0].setSelectionRange(0,e[0].value.length)):((t=e[0].createTextRange()).collapse(!0),t.moveEnd("character",e[0].value.length),t.moveStart("character",0),t.select())},10)},_setSelection:function(t,e){if(1!=this._disableSetSelection){var i,s=x.jqx.mobile.isTouchDevice();if(!s&&1!=this.touchMode)try{"selectionStart"in this.numberInput[0]?(this.numberInput[0].focus(),this.numberInput[0].setSelectionRange(t,e)):((i=this.numberInput[0].createTextRange()).collapse(!0),i.moveEnd("character",e),i.moveStart("character",t),i.select())}catch(t){}}},_setSelectionStart:function(t){this._setSelection(t,t),x.data(this.numberInput,"selectionstart",t)},resize:function(t,e){this.width=t,this.height=e,this._render(!1)},_render:function(t){var e=parseInt(this.host.css("border-left-width")),i=parseInt(this.host.css("border-left-width")),s=parseInt(this.host.css("border-left-width")),a=parseInt(this.host.css("border-left-width")),r=(this.numberInput.css("padding-top","0px"),this.numberInput.css("padding-bottom","0px"),window.getComputedStyle(this.element)),n=2*parseInt(r.borderLeftWidth),r=("border-box"!==r.boxSizing&&!isNaN(n)||(n=0),(null==this.width||-1==this.width.toString().indexOf("px"))&&(null==this.width||isNaN(this.width))||(this.element.style.width=parseInt(this.width)-n+"px"),(null==this.height||-1==this.height.toString().indexOf("px"))&&(null==this.height||isNaN(this.height))||(this.element.style.height=parseInt(this.height)-n+"px"),this.host.width()),n=this.host.height(),i=(this.numberInput.css({"border-left-width":0,"border-right-width":0,"border-bottom-width":0,"border-top-width":0}),isNaN(s)&&(s=1),isNaN(i),isNaN(a),isNaN(e),this.numberInput.css("text-align",this.textAlign),this.numberInput.css("font-size")),a=(""==i&&(i=13),this.numberInput.css("height",parseInt(i)+4+"px"),this.numberInput.css("width",r-2),n-2*s-parseInt(i)-2),e=((a=isNaN(a)?0:a)<0&&(a=0),this.spinButtons&&this.spincontainer&&(r-=parseInt(this.spinButtonsWidth-2),x.jqx.mobile.isTouchDevice()||!0===this.touchMode?(this.spincontainer.width(2*this.spinButtonsWidth),r-=this.spinButtonsWidth,this.upbutton.height("100%"),this.downbutton.height("100%"),this.downbutton.css("float","left"),this.upbutton.css("float","right"),this.upbutton.width(this.spinButtonsWidth),this.downbutton.width(1+this.spinButtonsWidth)):(this.spincontainer.width(this.spinButtonsWidth),this.upbutton.width(this.spinButtonsWidth+2),this.downbutton.width(this.spinButtonsWidth+2),this.upbutton.height("50%"),this.downbutton.height("50%"),this.spincontainer.width(this.spinButtonsWidth)),this._upArrow.height("100%"),this._downArrow.height("100%"),this.numberInput.css("width",r-6),this.numberInput.css("margin-right","2px")),a/2);x.jqx.browser.msie&&x.jqx.browser.version<8&&(e=a/4),this.numberInput.css("padding-left","0px"),this.numberInput.css("padding-right","0px"),this.numberInput.css("padding-top",Math.round(e)+"px"),this.numberInput.css("padding-bottom",Math.round(e)+"px"),null!=t&&1!=t||(this.numberInput.val(this._getString()),"advanced"!=this.inputMode&&this._parseDecimalInSimpleMode()),this._addBarAndLabel(this.numberInput),this._updateHint()},_addBarAndLabel:function(t){var e,i=this;null===i.bar&&null===i.label&&(e=x("<label></label"),this.hint&&(e[0].innerHTML=this.placeHolder),e.addClass(i.toThemeProperty("jqx-input-label")),t.after(e),i.label=e,e=x("<span></span>"),t.after(e),e.addClass(i.toThemeProperty("jqx-input-bar")),i.spinButtons?e.css("top",i.host.height()):e.css("top","0px"),i.bar=e,i.template&&(i.bar.addClass(i.toThemeProperty("jqx-"+i.template)),i.label.addClass(i.toThemeProperty("jqx-"+i.template))))},destroy:function(){this._removeHandlers(),this.host.remove()},inputValue:function(t){return void 0===t?this._value():(this.propertyChangedHandler(this,"value",this._value,t),this._refreshValue(),this)},_value:function(){return this.value},val:function(t){if((void 0===t||"object"==typeof t)&&null!==t)return this.getDecimal();if(null===t)this.setDecimal(null);else if((e=t)<0)this.setDecimal(e);else{this.setvalue("negative",!1);var e;e=function(t,e,i){var s=t;if(e==i)return t;for(var a=s.indexOf(e);-1!=a;)a=(s=s.replace(e,i)).indexOf(e);return s}(e=(e=-1<(e=e.toString()).indexOf(this.symbol)?e.replace(this.symbol,""):e).replace(this.decimalSeparator,"."),this.groupSeparator,"");for(var i="",s=0;s<e.length;s++){var a=e.substring(s,s+1);"-"===a&&(i+="-"),"."===a&&(i+="."),null!=a.match(/^[0-9]+$/)&&(i+=a)}e=(e=(e=i).replace(/ /g,"")).replace(".",this.decimalSeparator),this._setDecimal(e)}},getDecimal:function(){return null==this.decimal?null:("simple"==this.inputMode&&(this._parseDecimalInSimpleMode(!1),this.decimal=this._getDecimalInSimpleMode(this.decimal)),""==this.decimal?0:this.getvalue("negative")&&0<this.decimal?-parseFloat(this.decimal):parseFloat(this.decimal))},setDecimal:function(t){var e,i,s,a=t;"."!=this.decimalSeparator?null===t?this._setDecimal(t):("number"==typeof(e=t)||-1==(s=(t=t.toString()).indexOf("."))&&-1==(s=t.indexOf(this.decimalSeparator))||(e=(i=t.substring(0,s))+"."+(s=t.substring(s+1)),-1!=i.indexOf("-")&&(i=i.substring(1)),t="advanced"!=this.inputMode?i+"."+s:i+this.decimalSeparator+s),e<0?this.setvalue("negative",!0):this.setvalue("negative",!1),null===t?this._setDecimal(t):this._setDecimal(Math.abs(t))):(t<0?this.setvalue("negative",!0):this.setvalue("negative",!1),null===t?this._setDecimal(t):this._setDecimal(Math.abs(t))),null==a&&this.numberInput.val(""),this._updateHint()},_setDecimal:function(t){if(null==(t=this.allowNull||null!=t?t:this.decimal=0))return this.decimal=null,this.value=null,this.clearDecimal(),this._refreshValue(),this.decimal=null,this.value=null,void(this.ValueString="");-1!=t.toString().indexOf("e")&&(t=new Number(t).toFixed(this.decimalDigits).toString()),this.clearDecimal();var e=t.toString(),i="",s="",a=!0;0==e.length&&(e="0");for(var r=0;r<e.length;r++){if("number"==typeof t){if("."==e.substring(r,r+1)){a=!1;continue}}else if(e.substring(r,r+1)==this.decimalSeparator){a=!1;continue}a?i+=e.substring(r,r+1):s+=e.substring(r,r+1)}0<i.length&&(i=parseFloat(i).toString());for(var n=this.digits,o=(n<i.length&&(i=i.substr(0,n)),0),n=this._getSeparatorPosition(),r=n+=this._getHiddenPrefixCount();0<=r;r--)r<this.items.length&&this.items[r].canEdit&&o<i.length&&(this.items[r].character=i.substring(i.length-o-1,i.length-o),o++);for(o=0,r=n;r<this.items.length;r++)this.items[r].canEdit&&o<s.length&&(this.items[r].character=s.substring(o,o+1),o++);this._refreshValue(),"."!=this.decimalSeparator&&0<(n=t.toString().indexOf(this.decimalSeparator))?(n=t.toString().substring(0,n)+"."+t.toString().substring(n+1),this.ValueString=new Number(n).toFixed(this.decimalDigits)):this.ValueString=new Number(t).toFixed(this.decimalDigits),"advanced"!=this.inputMode&&(this._parseDecimalInSimpleMode(),this._raiseEvent(1,this.ValueString)),"textbox"==this.inputMode&&(this.decimal=this.ValueString,this.getvalue("negative")&&(this.decimal="-"+this.ValueString)),(t=this.val())<this.min||t>this.max?this.host.addClass("jqx-input-invalid"):this.host.removeClass("jqx-input-invalid"),this._updateHint()},_getSeparatorPosition:function(){var t=this._getHiddenPrefixCount();return 0<this.decimalSeparatorPosition?this.decimalSeparatorPosition-t:this.items.length-t},_setTheme:function(){this.host.removeClass(),this.host.addClass(this.toThemeProperty("jqx-input")),this.host.addClass(this.toThemeProperty("jqx-rc-all")),this.host.addClass(this.toThemeProperty("jqx-widget")),this.host.addClass(this.toThemeProperty("jqx-widget-content")),this.host.addClass(this.toThemeProperty("jqx-numberinput")),this.spinButtons&&(this.downbutton.removeClass(),this.upbutton.removeClass(),this.downbutton.addClass(this.toThemeProperty("jqx-scrollbar-button-state-normal")),this.upbutton.addClass(this.toThemeProperty("jqx-scrollbar-button-state-normal")),this._upArrow.removeClass(),this._downArrow.removeClass(),this._upArrow.addClass(this.toThemeProperty("jqx-icon-arrow-up")),this._downArrow.addClass(this.toThemeProperty("jqx-icon-arrow-down"))),this.numberInput.removeClass(),this.numberInput.addClass(this.toThemeProperty("jqx-input-content"))},propertiesChangedHandler:function(t,e,i){i&&i.width&&i.height&&2==Object.keys(i).length&&t._render()},propertyChangedHandler:function(t,e,i,s){if(!(t.batchUpdate&&t.batchUpdate.width&&t.batchUpdate.height&&2==Object.keys(t.batchUpdate).length)){if("template"==e&&(t.upbutton.removeClass(t.toThemeProperty("jqx-"+t.template)),t.downbutton.removeClass(t.toThemeProperty("jqx-"+t.template)),t.upbutton.addClass(t.toThemeProperty("jqx-"+t.template)),t.downbutton.addClass(t.toThemeProperty("jqx-"+t.template))),("digits"==e||"groupSize"==e||"decimalDigits"==e)&&s<0)throw new Exception(this.invalidArgumentExceptions[0]);var a,r;if("placeHolder"==e&&(t.isMaterialized()?t.hint&&(t.label[0].innerHTML=t.placeHolder):t.numberInput.attr("placeholder",t.placeHolder)),"theme"===e&&x.jqx.utilities.setTheme(i,s,t.host),"digits"==e&&s!=i&&(t.digits=parseInt(s)),"min"!=e&&"max"!=e||(x.jqx.aria(t,"aria-value"+e,s.toString()),t._refreshValue()),"decimalDigits"==e&&s!=i&&(t.decimalDigits=parseInt(s)),"decimalSeparator"!=e&&"digits"!=e&&"symbol"!=e&&"symbolPosition"!=e&&"groupSize"!=e&&"groupSeparator"!=e&&"decimalDigits"!=e&&"negativeSymbol"!=e||(a=t.decimal,i!=(s="decimalSeparator"==e&&""==s?" ":s)&&(r=t._selection(),t.items=new Array,t._initializeLiterals(),t.value=t._getString(),t._refreshValue(),t._setDecimal(a))),"rtl"==e&&(t.rtl?(t.spincontainer&&(t.spincontainer.css("float","right"),t.spincontainer.css("border-right-width","1px")),t.numberInput.css("float","right")):(t.spincontainer&&(t.spincontainer.css("float","right"),t.spincontainer.css("border-right-width","1px")),t.numberInput.css("float","left"))),"spinButtons"==e&&(t.spincontainer?(s?t.spincontainer.css("display","block"):t.spincontainer.css("display","none"),t._render()):t._spinButtons()),"touchMode"===e&&(t.inputMode="textbox",t.spinMode="simple",t.render()),"negative"==e&&"advanced"==t.inputMode&&(r=t._selection(),i=0,i=s?(t.items[0].character=t.negativeSymbol[0],1):(t.items[0].character="",-1),t._refreshValue(),t.isInitialized&&t._setSelection(r.start+i,r.end+i)),"decimal"==e&&(t.value=s,t.setDecimal(s)),"value"===e&&(t.value=s,t.setDecimal(s),t._raiseEvent(1,s)),"textAlign"==e&&(t.textAlign=s,t._render()),"disabled"==e&&(t.numberInput.attr("disabled",s),t.disabled?t.host.addClass(t.toThemeProperty("jqx-fill-state-disabled")):t.host.removeClass(t.toThemeProperty("jqx-fill-state-disabled")),x.jqx.aria(t,"aria-disabled",s.toString())),"readOnly"==e&&(t.readOnly=s),"promptChar"==e){for(var n=0;n<t.items.length;n++)t.items[n].character==t.promptChar&&(t.items[n].character=s);t.promptChar=s}"width"==e?(t.width=s,t._render()):"height"==e&&(t.height=s,t._render())}},_refreshValue:function(){this.value;if("textbox"!==this.inputMode){this.value=this._getString();for(var t=this.value,e="",i=0;i<this.items.length;i++){var s=this.items[i];s.canEdit&&s.character!=this.promptChar&&(e+=s.character),i==this.decimalSeparatorPosition&&(e+=".")}this.decimal=e;var a=!1;this.oldValue!==t&&(this.oldValue=t,this._raiseEvent(0,t),a=!0),"simple"!=this.inputMode&&(this.numberInput.val(t),a&&this._raiseEvent(1,t)),null==t&&this.numberInput.val("")}}})}(jqxBaseFramework);