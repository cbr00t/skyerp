!function(v){v.jqx.jqxWidget("jqxEditor","",{}),v.extend(v.jqx._jqxEditor.prototype,{defineInstance:function(){var e={width:null,height:null,disabled:!1,pasteMode:"html",editable:!0,lineBreak:"default",changeType:null,toolbarPosition:"top",fontFamily:"sans-serif",commands:{bold:{tooltip:"Bold",command:"bold",type:"toggleButton"},italic:{tooltip:"Italic",command:"italic",type:"toggleButton"},underline:{tooltip:"Underline",command:"underline",type:"toggleButton"},format:{placeHolder:"Format Block",tooltip:"Format Block",command:"formatblock",value:[{value:"p",label:"Paragraph"},{value:"h1",label:"Header 1"},{value:"h2",label:"Header 2"},{value:"h3",label:"Header 3"},{value:"h4",label:"Header 4"}],type:"list",width:120,dropDownWidth:190,height:25},font:{placeHolder:"Font",tooltip:"Font Name",command:"fontname",value:[{label:"Arial",value:"Arial, Helvetica, sans-serif"},{label:"Comic Sans MS",value:'"Comic Sans MS", cursive, sans-serif'},{label:"Courier New",value:'"Courier New", Courier, monospace'},{label:"Georgia",value:"Georgia,serif"},{label:"Impact",value:"Impact,Charcoal,sans-serif"},{label:"Lucida Console",value:"'Lucida Console',Monaco,monospace"},{label:"Tahoma",value:"Tahoma,Geneva,sans-serif"},{label:"Times New Roman",value:"'Times New Roman',Times,serif"},{label:"Trebuchet MS",value:'"Trebuchet MS",Helvetica,sans-serif'},{label:"Verdana",value:"Verdana,Geneva,sans-serif"}],type:"list",width:160,height:25,dropDownWidth:160},size:{placeHolder:"Size",tooltip:"Font Size",command:"fontsize",value:[{label:"1 (8pt)",value:"xx-small"},{label:"2 (10pt)",value:"x-small"},{label:"3 (12pt)",value:"small"},{label:"4 (14pt)",value:"medium"},{label:"5 (18pt)",value:"large"},{label:"6 (24pt)",value:"x-large"},{label:"7 (36pt)",value:"xx-large"}],type:"list",width:45,height:25,dropDownWidth:160},color:{tooltip:"Text Color",command:"forecolor",value:"#000",type:"colorPicker"},background:{tooltip:"Fill Color",command:"backcolor",value:"#fff",type:"colorPicker"},left:{tooltip:"Align Left",command:"justifyleft",type:"toggleButton"},center:{tooltip:"Align Center",command:"justifycenter",type:"toggleButton"},right:{tooltip:"Align Right",command:"justifyright",type:"toggleButton"},outdent:{tooltip:"Indent Less",command:"outdent",type:"button"},indent:{tooltip:"Indent More",command:"indent",type:"button"},ul:{tooltip:"Insert unordered list",command:"insertunorderedlist",type:"toggleButton"},ol:{tooltip:"Insert ordered list",command:"insertorderedlist",type:"toggleButton"},image:{tooltip:"Insert image",command:"insertimage",type:"button"},link:{tooltip:"Insert link",command:"createlink",type:"toggleButton"},html:{tooltip:"View source",command:"viewsource",type:"toggleButton"},clean:{tooltip:"Remove Formatting",command:"removeformat",type:"button"}},createCommand:null,defaultLocalization:{bold:"Bold",italic:"Italic",underline:"Underline",format:"Format Block",font:"Font Name",size:"Font Size",color:"Text Color",background:"Fill Color",left:"Align Left",center:"Align Center",right:"Align Right",outdent:"Indent Less",indent:"Indent More",ul:"Insert unordered list",ol:"Insert ordered list",image:"Insert image",link:"Insert link",html:"View source",clean:"Remove Formatting",Remove:"Remove",Ok:"Ok",Cancel:"Cancel",Change:"Change","Go to link":"Go to link","Open in a new window/tab":"Open in a new window/tab",Align:"Align",VSpace:"VSpace",HSpace:"HSpace",Width:"Width",Height:"Height",Title:"Title",URL:"URL","Insert Image":"Insert Image","Insert Link":"Insert Link","Alt Text":"Alt Text","not set":"&ltnot set&gt",Left:"Left",Right:"Right",Paragraph:"Paragraph",Header:"Header",Arial:"Arial","Comic Sans MS":"Comic Sans MS","Courier New":"Courier New",Georgia:"Georgia",Impact:"Impact","Lucida Console":"Lucida Console",Tahoma:"Tahoma","Times New Roman":"Times New Roman","Trebuchet MS":"Trebuchet MS",Verdana:"Verdana"},localization:null,tools:"bold italic underline | format font size | color background | left center right | outdent indent | ul ol | image | link | clean | html",readOnly:!1,stylesheets:new Array,rtl:!1,colorPickerTemplate:'<div class="jqx-editor-color-picker"><div role="grid"><table class="jqx-editor-color-picker-table" cellspacing="0" cellpadding="0"><tbody><tr><td aria-label="RGB (0, 0, 0)"><div title="RGB (0, 0, 0)" style="background-color: rgb(0, 0, 0);"></div></td><td aria-label="RGB (68, 68, 68)"><div title="RGB (68, 68, 68)" style="background-color: rgb(68, 68, 68);"></div></td><td aria-label="RGB (102, 102, 102)"><div title="RGB (102, 102, 102)" style="background-color: rgb(102, 102, 102);"></div></td><td aria-label="RGB (153, 153, 153)"><div title="RGB (153, 153, 153)" style="background-color: rgb(153, 153, 153);"></div></td><td aria-label="RGB (204, 204, 204)"><div title="RGB (204, 204, 204)" style="background-color: rgb(204, 204, 204);"></div></td><td aria-label="RGB (238, 238, 238)"><div title="RGB (238, 238, 238)" style="background-color: rgb(238, 238, 238);"></div></td><td aria-label="RGB (243, 243, 243)"><div title="RGB (243, 243, 243)" style="background-color: rgb(243, 243, 243);"></div></td><td aria-label="RGB (255, 255, 255)"><div title="RGB (255, 255, 255)" style="background-color: rgb(255, 255, 255);"></div></td></tr></tbody></table></div><div role="grid"><table class="jqx-editor-color-picker-table" cellspacing="0" cellpadding="0"><tbody><tr><td aria-label="RGB (255, 0, 0)"><div title="RGB (255, 0, 0)" style="background-color: rgb(255, 0, 0);"></div></td><td aria-label="RGB (255, 153, 0)"><div title="RGB (255, 153, 0)" style="background-color: rgb(255, 153, 0);"></div></td><td aria-label="RGB (255, 255, 0)"><div title="RGB (255, 255, 0)" style="background-color: rgb(255, 255, 0);"></div></td><td aria-label="RGB (0, 255, 0)"><div title="RGB (0, 255, 0)" style="background-color: rgb(0, 255, 0);"></div></td><td aria-label="RGB (0, 255, 255)"><div title="RGB (0, 255, 255)" style="background-color: rgb(0, 255, 255);"></div></td><td aria-label="RGB (0, 0, 255)"><div title="RGB (0, 0, 255)" style="background-color: rgb(0, 0, 255);"></div></td><td aria-label="RGB (153, 0, 255)"><div title="RGB (153, 0, 255)" style="background-color: rgb(153, 0, 255);"></div></td><td aria-label="RGB (255, 0, 255)"><div title="RGB (255, 0, 255)" style="background-color: rgb(255, 0, 255);"></div></td></tr></tbody></table></div><div role="grid"><table class="jqx-editor-color-picker-table" cellspacing="0" cellpadding="0"><tbody><tr><td aria-label="RGB (244, 204, 204)"><div title="RGB (244, 204, 204)" style="background-color: rgb(244, 204, 204);"></div></td><td aria-label="RGB (252, 229, 205)"><div title="RGB (252, 229, 205)" style="background-color: rgb(252, 229, 205);"></div></td><td aria-label="RGB (255, 242, 204)"><div title="RGB (255, 242, 204)" style="background-color: rgb(255, 242, 204);"></div></td><td aria-label="RGB (217, 234, 211)"><div title="RGB (217, 234, 211)" style="background-color: rgb(217, 234, 211);"></div></td><td aria-label="RGB (208, 224, 227)"><div title="RGB (208, 224, 227)" style="background-color: rgb(208, 224, 227);"></div></td><td aria-label="RGB (207, 226, 243)"><div title="RGB (207, 226, 243)" style="background-color: rgb(207, 226, 243);"></div></td><td aria-label="RGB (217, 210, 233)"><div title="RGB (217, 210, 233)" style="background-color: rgb(217, 210, 233);"></div></td><td aria-label="RGB (234, 209, 220)"><div title="RGB (234, 209, 220)" style="background-color: rgb(234, 209, 220);"></div></td></tr><tr><td id="T-Kw-Jn88" aria-label="RGB (234, 153, 153)"><div title="RGB (234, 153, 153)" style="background-color: rgb(234, 153, 153);"></div></td><td aria-label="RGB (249, 203, 156)"><div title="RGB (249, 203, 156)" style="background-color: rgb(249, 203, 156);"></div></td><td aria-label="RGB (255, 229, 153)"><div title="RGB (255, 229, 153)" style="background-color: rgb(255, 229, 153);"></div></td><td aria-label="RGB (182, 215, 168)"><div title="RGB (182, 215, 168)" style="background-color: rgb(182, 215, 168);"></div></td><td aria-label="RGB (162, 196, 201)"><div title="RGB (162, 196, 201)" style="background-color: rgb(162, 196, 201);"></div></td><td aria-label="RGB (159, 197, 232)"><div title="RGB (159, 197, 232)" style="background-color: rgb(159, 197, 232);"></div></td><td aria-label="RGB (180, 167, 214)"><div title="RGB (180, 167, 214)" style="background-color: rgb(180, 167, 214);"></div></td><td aria-label="RGB (213, 166, 189)"><div title="RGB (213, 166, 189)" style="background-color: rgb(213, 166, 189);"></div></td></tr><tr><td aria-label="RGB (224, 102, 102)"><div title="RGB (224, 102, 102)" style="background-color: rgb(224, 102, 102);"></div></td><td aria-label="RGB (246, 178, 107)"><div title="RGB (246, 178, 107)" style="background-color: rgb(246, 178, 107);"></div></td><td aria-label="RGB (255, 217, 102)"><div title="RGB (255, 217, 102)" style="background-color: rgb(255, 217, 102);"></div></td><td aria-label="RGB (147, 196, 125)"><div title="RGB (147, 196, 125)" style="background-color: rgb(147, 196, 125);"></div></td><td aria-label="RGB (118, 165, 175)"><div title="RGB (118, 165, 175)" style="background-color: rgb(118, 165, 175);"></div></td><td aria-label="RGB (111, 168, 220)"><div title="RGB (111, 168, 220)" style="background-color: rgb(111, 168, 220);"></div></td><td aria-label="RGB (142, 124, 195)"><div title="RGB (142, 124, 195)" style="background-color: rgb(142, 124, 195);"></div></td><td aria-label="RGB (194, 123, 160)"><div title="RGB (194, 123, 160)" style="background-color: rgb(194, 123, 160);"></div></td></tr><tr><td id="T-Kw-Jn104" aria-label="RGB (204, 0, 0)"><div title="RGB (204, 0, 0)" style="background-color: rgb(204, 0, 0);"></div></td><td aria-label="RGB (230, 145, 56)"><div title="RGB (230, 145, 56)" style="background-color: rgb(230, 145, 56);"></div></td><td aria-label="RGB (241, 194, 50)"><div title="RGB (241, 194, 50)" style="background-color: rgb(241, 194, 50);"></div></td><td aria-label="RGB (106, 168, 79)"><div title="RGB (106, 168, 79)" style="background-color: rgb(106, 168, 79);"></div></td><td aria-label="RGB (69, 129, 142)"><div title="RGB (69, 129, 142)" style="background-color: rgb(69, 129, 142);"></div></td><td aria-label="RGB (61, 133, 198)"><div title="RGB (61, 133, 198)" style="background-color: rgb(61, 133, 198);"></div></td><td aria-label="RGB (103, 78, 167)"><div title="RGB (103, 78, 167)" style="background-color: rgb(103, 78, 167);"></div></td><td aria-label="RGB (166, 77, 121)"><div title="RGB (166, 77, 121)" style="background-color: rgb(166, 77, 121);"></div></td></tr><tr><td aria-label="RGB (153, 0, 0)"><div title="RGB (153, 0, 0)" style="background-color: rgb(153, 0, 0);"></div></td><td aria-label="RGB (180, 95, 6)"><div title="RGB (180, 95, 6)" style="background-color: rgb(180, 95, 6);"></div></td><td aria-label="RGB (191, 144, 0)"><div title="RGB (191, 144, 0)" style="background-color: rgb(191, 144, 0);"></div></td><td aria-label="RGB (56, 118, 29)"><div title="RGB (56, 118, 29)" style="background-color: rgb(56, 118, 29);"></div></td><td aria-label="RGB (19, 79, 92)"><div title="RGB (19, 79, 92)" style="background-color: rgb(19, 79, 92);"></div></td><td aria-label="RGB (11, 83, 148)"><div title="RGB (11, 83, 148)" style="background-color: rgb(11, 83, 148);"></div></td><td aria-label="RGB (53, 28, 117)"><div title="RGB (53, 28, 117)" style="background-color: rgb(53, 28, 117);"></div></td><td aria-label="RGB (116, 27, 71)"><div title="RGB (116, 27, 71)" style="background-color: rgb(116, 27, 71);"></div></td></tr><tr><td aria-label="RGB (102, 0, 0)"><div title="RGB (102, 0, 0)" style="background-color: rgb(102, 0, 0);"></div></td><td aria-label="RGB (120, 63, 4)"><div title="RGB (120, 63, 4)" style="background-color: rgb(120, 63, 4);"></div></td><td aria-label="RGB (127, 96, 0)"><div title="RGB (127, 96, 0)" style="background-color: rgb(127, 96, 0);"></div></td><td aria-label="RGB (39, 78, 19)"><div title="RGB (39, 78, 19)" style="background-color: rgb(39, 78, 19);"></div></td><td aria-label="RGB (12, 52, 61)"><div title="RGB (12, 52, 61)" style="background-color: rgb(12, 52, 61);"></div></td><td aria-label="RGB (7, 55, 99)"><div title="RGB (7, 55, 99)" style="background-color: rgb(7, 55, 99);"></div></td><td aria-label="RGB (32, 18, 77)"><div title="RGB (32, 18, 77)" style="background-color: rgb(32, 18, 77);"></div></td><td aria-label="RGB (76, 17, 48)"><div title="RGB (76, 17, 48)" style="background-color: rgb(76, 17, 48);"></div></td></tr></tbody></table></div></div>',touchMode:!1,keyPressed:null,events:["change"]};return this===v.jqx._jqxEditor.prototype||(v.extend(!0,this,e),this.localization=this.defaultLocalization),e},createInstance:function(e){var n=this,t=(n.textArea=n.host,n.host.attr("contenteditable"));if(n.host.addClass(n.toThemeProperty("jqx-widget")),1==t||"true"==t){n.inline=!0,n.widget=n.host,n.editorDocument=document,n.selection=new d(n.editorDocument);t=v("<div class='jqx-editor-toolbar-container' unselectable='on' aria-label='Formatting options' role='toolbar'><div class='jqx-editor-toolbar'></div>");t.insertBefore(n.host),n.toolbarContainer=t,n.toolbar=t.find(".jqx-editor-toolbar"),n.editor=n.host,n.contentEditableElement=n.element}else{var r=v("<div class='jqx-editor'><div class='jqx-editor-container'><div class='jqx-editor-toolbar-container' aria-label='Formatting options' role='toolbar'><div class='jqx-editor-toolbar'></div></div><div class='jqx-editor-content'><iframe  src='javascript:\"<html></html>\"' allowtransparency='true' frameborder='0'></iframe></div></div></div>");n.widget=r,n.widget[0].className=n.widget[0].className+" "+n.element.className;try{n.widget[0].style=n.element.style}catch(e){}var a=v.trim(n.host.html())+"&#8203;",l=("default"==n.lineBreak||"div"==n.lineBreak?a="<div>"+a+"</div>":"p"==n.lineBreak&&(a="<p>"+a+"</p>"),a=(a=a.replace(/&lt;/gi,"<")).replace(/&gt;/gi,">"),n.host.css("display","none"),n.host.after(r),r.find("iframe").after(n.host),n.container=r.find(".jqx-editor-container"),n.toolbarContainer=r.find(".jqx-editor-toolbar-container"),n.toolbar=r.find(".jqx-editor-toolbar"),n.iframe=r.find("iframe"),n.content=r.find(".jqx-editor-content"),function(){n.editorDocument=n.iframe[0].contentWindow.document,n.selection=new d(n.editorDocument);var e,t=0,o=(n.addHandler(n.iframe,"load",function(){1<++t&&(n.iframe.off("load"),n.content.find("iframe").remove(),v("<iframe  src='javascript:\"<html></html>\"' allowtransparency='true' frameborder='0'></iframe>").appendTo(n.content),n.iframe=r.find("iframe"),l())}),v.jqx.browser.mozilla||(n.editorDocument.designMode="On"),n.editorDocument.open(),n.rtl?"direction:rtl;":""),i=v.jqx.browser.msie?"::selection{color: #fff; background: #328EFD;};::-moz-selection{color: #fff; background: #328eD;};::selection:window-inactive {background: #c7c7c7; color: #000;}::-moz-selection:window-inactive {background: #c7c7c7; color: #000;}html{font-size:13px; height:100%;}body{padding-top:1px;margin-top:-1px; padding-right: 1px; overflow-x: hidden;word-wrap: break-word;-webkit-nbsp-mode: space;-webkit-line-break: after-white-space;":"";n.editorDocument.write("<!DOCTYPE html><html><head><meta charset='utf-8' /><style>html,body{padding:0; margin:0; font-size: 13px; font-family: "+n.fontFamily+"; background:#fff; min-height:100%; "+o+"}"+i+"}h1{font-size:2em;margin:.67em 0}h2{font-size: 1.5em; margin: .75em 0}h3{font-size: 1.17em; margin: .83em 0}h4{font-size:1em; margin: 1.12em 0 }h5{font-size: .83em; margin: 1.5em 0}h6{font-size: .75em; margin: 1.67em 0}p{margin: 0px;padding:0 .2em}ul,ol{padding-left:2.5em}a{color:#00a}code{font-size:1.23em}.jqx-editor-paste-element {position: absolute; left: -1000px; height: 1px; overflow: hidden; top: -1000px;}.jqx-editor-focus {border: 1px solid #aaa !important;}</style>"+v.map(n.stylesheets,function(e){return"<link rel='stylesheet' href='"+e+"'>"}).join("")+"</head><body autocorrect='off' contenteditable='true'></body></html>"),n.contentEditableElement=n.editorDocument.body,n.host.is("textarea")?(n._textArea=n.element,(e=n.host.data()).jqxEditor.host=r,e.jqxEditor.element=r[0],n.element=r[0],r[0].id=n._textArea.id,n._textArea.id=n._textArea.id+"TextArea",v(n.element).addClass(n.toThemeProperty("jqx-widget"))):((e=n.host.data()).jqxEditor.host=r,e.jqxEditor.element=r[0],n.element=r[0]),n.host=v(n.element),n.host.data(e);try{n.editorDocument.execCommand("useCSS",!1,!1),n.editorDocument.execCommand("enableInlineTableEditing",null,!1)}catch(e){}try{n.editorDocument.execCommand("styleWithCSS",0,!0)}catch(e){}n.editorDocument.close(),n.editor=v(n.editorDocument.body),n.editor.html(a).attr("spellcheck",!1).attr("autocorrect","off")});l(),v.jqx.utilities.resize(n.host,function(){n.widget.css("width",n.width),n.widget.css("height",n.height),n._arrange()})}},focus:function(){var e=this,t=(!v.jqx.browser.mozilla||e.focused||(e.iframe&&e.iframe.focus(),e.selection.selectNode(e.editor[0].firstChild,!0),e.selection.getRange().collapse(!0)),e.editor.focus(),null!=e.range?e.range:e.getRange());e.selectRange(t)},print:function(){var e=window.open("","_blank","width=450,height=470,left=400,top=100,menubar=yes,toolbar=no,location=no,scrollbars=yes");e.document.open(),e.document.write('<!doctype html><html><head><title>Print</title></head><body onload="print();">'+this.val()+"</body></html>"),e.document.close()},refresh:function(e){var b=this,t=(v.each(this.defaultLocalization,function(e,t){b.localization[e]||(b.localization[e]=t)}),b._removeHandlers(),b.toolbar.addClass(b.toThemeProperty("jqx-widget-header")),b.content?(b.widget.css("width",b.width),b.widget.css("height",b.height),b.widget.addClass(b.toThemeProperty("jqx-editor")),b.widget.addClass(b.toThemeProperty("jqx-widget")),b.widget.addClass(b.toThemeProperty("jqx-rc-all")),b.widget.addClass(b.toThemeProperty("jqx-widget-header")),b.content.addClass(b.toThemeProperty("jqx-widget-content")),b.container.addClass(b.toThemeProperty("jqx-editor-container"))):(b.toolbarContainer.addClass(b.toThemeProperty("jqx-widget-header")),b.toolbarContainer.addClass(b.toThemeProperty("jqx-editor-toolbar-inline")),b.toolbarContainer.addClass(b.toThemeProperty("jqx-widget")),b.toolbarContainer.addClass(b.toThemeProperty("jqx-rc-all")),b.toolbarContainer.hide(),b.toolbarContainer.css("position","absolute"),b.editor.addClass(b.toThemeProperty("jqx-editor-inline")),b.toolbarContainer.css("width",b.host.outerWidth()+"px")),b.toolbarContainer.index()),t=(("top"==b.toolbarPosition&&0!=t||"bottom"==b.toolbarPosition&&1!=t)&&("bottom"===b.toolbarPosition?b.toolbarContainer.insertAfter(b.content):b.toolbarContainer.insertBefore(b.content)),b.tools);if(!1!==t){function o(m,f){v.each(f,function(e,t){var o,d=b.commands[this];if(d)b.createCommand&&(o=b.createCommand(this.toString()),d=v.extend(d,o));else{if(!b.createCommand)return!0;if(!(d=b.createCommand(this.toString())))return!0;b.commands[this]||(b.commands[this]=d)}switch(b.localization[this]&&(d.tooltip=b.localization[this]),d.type){case"list":d.widget&&d.widget.jqxDropDownList("destroy");var i="formatblock"==d.command||"fontname"==d.command||"fontsize"==d.command,n=d.value||[],r=new Array,a=d.placeHolder||"Please Choose:",n=("fontname"==d.command?v.each(n,function(){var e=b.localization[this.label];r.push({label:e,value:this.value})}):"formatblock"==d.command?(a=b.localization.format,v.each(n,function(){var e;e=0<=this.label.indexOf("Header")?this.label.replace("Header",b.localization.Header):b.localization[this.label],r.push({label:e,value:this.value})})):r=n,{enableBrowserBoundsDetection:!0,touchMode:b.touchMode,width:d.width||100,height:d.height||25,dropDownWidth:d.dropDownWidth||"auto",autoDropDownHeight:(d.value&&d.value.length)<12,placeHolder:a,source:r,theme:b.theme,hint:!1,keyboardSelection:!1,focusable:!1,disabled:b.disabled,rtl:b.rtl,selectionRenderer:"fontsize"==d.command?function(){return"<div unselectable='on' style='margin-top: 0px; padding:0px;' class='"+(b.toThemeProperty("jqx-editor-toolbar-icon")+" "+b.toThemeProperty("jqx-editor-toolbar-icon-"+d.command))+"'></div>"}:null,renderer:i?function(e,t,o){return"formatblock"==d.command?"<"+o+' unselectable="on" style="padding: 0px; margin: 0px;">'+t+"</"+o+">":"fontname"==d.command?'<span unselectable="on" style="font-family: '+o+';">'+t+"<span>":"fontsize"==d.command?'<span unselectable="on" style="font-size: '+o+';">'+t+"<span>":void 0}:null}),a="jqx-disableselect "+b.toThemeProperty("jqx-editor-dropdownlist")+" "+b.toThemeProperty("jqx-editor-toolbar-item"),t=((h=v("<div unselectable='on' class='"+a+"'></div>")).appendTo(m),h.jqxDropDownList(n),d.init&&d.init(h),null),l=null,s="";b.addHandler(h,"mousedown",function(e){var t;0<v(".jqx-editor-dropdownpicker").length&&v(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),0<v(".jqx-editor-dropdownlist").length&&(t=v(".jqx-editor-dropdownlist"),v.each(t,function(e,t){t!=h[0]&&v(t).jqxDropDownList("close")}))}),b.addHandler(h,"open",function(e){b.focused||b.focus(),b.updating=!0,b.activeElement=h,t=h.val(),s=""}),b.addHandler(h,"change",function(e){b.updating=!1,b.activeElement=null,l=h.val(),s=e.args.type,v.jqx.browser.msie&&v.jqx.browser.version<9&&b.focus()}),b.addHandler(h,"close",function(e){b.updating=!1,b.activeElement=null,t==l||"mouse"!=s&&"keyboard"!=s||b._refreshTools()}),b._addCommandHandler(h,"change",d.command,null,d);break;case"colorPicker":d.widget&&(v(d.colorPicker).remove(),d.widget.jqxDropDownButton("destroy"));var c=v('<div unselectable="on" style="padding-top: 4px;"></div>').attr("id","picker-"+d.command),a="jqx-disableselect "+b.toThemeProperty("jqx-editor-dropdownpicker")+" "+b.toThemeProperty("jqx-editor-toolbar-item"),i=((h=v("<div unselectable='on' class='"+a+"'></div>")).appendTo(m),h.append(c),h.jqxDropDownButton({hint:!1,touchMode:b.touchMode,disabled:b.disabled,enableBrowserBoundsDetection:!0,width:d.width||45,height:d.height||25,rtl:b.rtl,focusable:!1,theme:b.theme}),v('<div unselectable="on" style="z-index: 55;">')),u=b.toThemeProperty("jqx-editor-toolbar-icon")+" "+b.toThemeProperty("jqx-editor-toolbar-icon-"+d.command),g=v("<div unselectable='on' class='"+u+"'></div>"),n=(i.append(g),v('<div unselectable="on" class="jqx-editor-color-bar">').attr("id","bar-"+d.command).css("background-color",d.value)),p=(i.append(n),h.jqxDropDownButton("setContent",i),c.append(v(b.colorPickerTemplate)),d.colorPicker=c,d.init&&d.init(h),c.find("tr").attr("role","row").attr("unselectable","on"),c.find("td").attr("role","gridcell").attr("unselectable","on").css("-webkit-user-select","none"),c.find("div").attr("unselectable","on"),b.addHandler(h,"mousedown",function(e){var t;0<v(".jqx-editor-dropdownlist").length&&v(".jqx-editor-dropdownlist").jqxDropDownList("close"),0<v(".jqx-editor-dropdownpicker").length&&(t=v(".jqx-editor-dropdownpicker"),v.each(t,function(e,t){t!=h[0]&&v(t).jqxDropDownButton("close")}))}),b.addHandler(h,"open",function(){b.focused||b.focus(),b.updating=!0,b.activeElement=c}),b.addHandler(h,"close",function(e){b.updating=!1,b.activeElement=null,t==l||"mouse"!=s&&"keyboard"!=s||b._refreshTools()}),b.addHandler(c,"keydown",function(e){var e=e.keyCode,t=v(c).find(".jqx-editor-color-picker-selected-cell"),o=c.find("tr"),i=o.length,n=t.parent().children().length,r=t.index(),a=-999,l=t.parent();switch(v.each(o,function(e,t){if(this==l[0])return a=e,!1}),e){case 27:h.jqxDropDownButton("close");break;case 13:v(t).trigger("mousedown");break;case 38:a--;break;case 40:a++;break;case 39:r++;break;case 37:r--}0<=a&&a<=i&&0<=r&&r<=n&&(l=c.find("tr")[a],o=v(l).children()[r],e=v(o).children().css("background-color"),d.val(e))}),v(c).find("td"));d.val=function(e){var t=b._rgbToHex(e);v.each(p,function(){var e=v(this).children().css("background-color");if(b._rgbToHex(e)==t)return p.removeClass("jqx-editor-color-picker-selected-cell"),v(this).addClass("jqx-editor-color-picker-selected-cell"),v("#bar-"+d.command).css("background",e),!1})},d.val(d.value),b._addCommandHandler(p,"mousedown",d.command,null,d);break;default:d.widget&&("button"==d.type?d.widget.jqxButton("destroy"):d.widget.jqxToggleButton("destroy"));var a=d.command,n=d.action,u=b.toThemeProperty("jqx-editor-toolbar-icon")+" "+b.toThemeProperty("jqx-editor-toolbar-icon-"+a),g=v("<div unselectable='on' class='"+u+"'></div>"),h=v("<div unselectable='on'></div>").addClass("jqx-disableselect").addClass(b.toThemeProperty("jqx-editor-toolbar-button"));(!d.init||a)&&h.append(g),h.appendTo(m),"button"==d.type?h.jqxButton({disabled:b.disabled,rtl:b.rtl,theme:b.theme}):"toggleButton"==d.type&&h.jqxToggleButton({disabled:b.disabled,rtl:b.rtl,uiToggle:!1,theme:b.theme}),d.init&&d.init(h),d.toggled=!1,d.toggle=function(){d.toggled=!d.toggled},b.addHandler(h,"mousedown",function(e){return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}),v.jqx.mobile.isTouchDevice()?b._addCommandHandler(h,"mousedown",a,n,d):b._addCommandHandler(h,"click",a,n,d)}if(d.widget=h){try{""!=d.tooltip&&(d.widget.attr("title",d.tooltip),d.widget.attr("data-tooltip",d.tooltip)),d.command&&d.widget.attr("data-command",d.command),d.widget.attr("aria-label",d.tooltip)}catch(e){}"button"!=d.type&&"toggleButton"!=d.type||(2<f.length&&(0==e?(h.css("border-right-radius","0px"),h.addClass(b.toThemeProperty("jqx-rc-l"))):e==f.length-1&&(h.css("border-left-radius","0px"),h.addClass(b.toThemeProperty("jqx-rc-r"))),h.removeClass(b.toThemeProperty("jqx-rc-all"))),0!=e&&e!=f.length-1&&2<f.length?(h.css("border-left-radius","0px"),h.css("border-right-radius","0px"),h.removeClass(b.toThemeProperty("jqx-rc-all"))):2==f.length?(0==e?(h.css("border-right-radius","0px"),h.addClass(b.toThemeProperty("jqx-rc-l"))):(h.css("border-left-radius","0px"),h.addClass(b.toThemeProperty("jqx-rc-r"))),h.removeClass(b.toThemeProperty("jqx-rc-all"))):1==f.length&&h.css("margin-right","0px"))}})}var i=t.split(" "),n=t.split(" | ");if(b.toolbar.css("direction",this.rtl?"rtl":"ltr"),0==n.length)o(b.toolbar,i);else{for(var r=0;r<n.length;r++){var i=n[r].split(" "),a=b.toThemeProperty("jqx-editor-toolbar-group")+" "+b.toThemeProperty("jqx-fill-state-normal"),a=v("<div class='"+a+"'></div>");a.addClass(b.toThemeProperty("jqx-rc-all")),b.toolbar.append(a),o(a,i)}for(var l=b.toolbar.find(".jqx-editor-toolbar-group"),d=l.length,r=0;r<d;r++)0==v(l[r]).children().length&&v(l[r]).remove()}v.jqx.browser.msie&&v.jqx.browser.version<8&&(v(".jqx-editor-toolbar-group").css("float","left"),v(".jqx-editor-toolbar-group").children().css("float","left"),v(".jqx-editor-toolbar-group").css("zoom","1"),v(".jqx-editor-toolbar-group").children().css("zoom","1"))}b._arrange(),b._addHandlers()},_arrange:function(){var e=this;e.content&&(""==e.tools||0==e.tools?(e.content.height(e.container.outerHeight()-parseInt(e.container.css("padding-top"))-parseInt(e.container.css("padding-bottom"))-6),e.content.css("margin-top","4px"),e.toolbar.hide()):(e.toolbar.show(),e.content.css("margin-top","0px"),e.content.height(e.container.outerHeight()-e.toolbar.outerHeight()-parseInt(e.container.css("padding-top"))-parseInt(e.container.css("padding-bottom"))-2),"top"!=e.toolbarPosition&&(e.content.css("margin-top","4px"),e.content.css("margin-bottom","0px"))),v.jqx.browser.msie&&v.jqx.browser.version<8&&(e.content.css("margin-top","4px"),e.content.height(e.container.height()-e.toolbar.outerHeight()-2*parseInt(e.container.css("padding-bottom"))-10),e.content.width(e.container.width()-2*parseInt(e.container.css("padding-left"))-2)),e.editor.height()<e.content.height()&&e.editor.height(e.content.height()))},propertyChangedHandler:function(e,t,o,i){null!=e.isInitialized&&0!=e.isInitialized&&"pasteMode"!=t&&"lineBreak"!=t&&"editable"!=t&&("disabled"==t&&e._refreshTools(),"width"==t||"height"==t||"toolbarPosition"==t?e._arrange():("theme"==t&&v.jqx.utilities.setTheme(o,i,e.host),e.refresh()))},selectRange:function(e){e=e||this.getRange(),this.selection.selectRange(e)},getRange:function(){return this.selection.getRange()},getSelectedElement:function(){var e,t,o,i,n;try{if(this.editorDocument.getSelection)return o=(t=(e=this.editorDocument.getSelection()).getRangeAt(e.rangeCount-1)).startContainer,i=t.endContainer,n=t.commonAncestorContainer,"#text"==o.nodeName&&(n=n.parentNode),(o="body"==(o="#text"==o.nodeName?o.parentNode:o).nodeName.toLowerCase()?o.firstChild:o)==(i="body"==(i="#text"==i.nodeName?i.parentNode:i).nodeName.toLowerCase()?i.lastChild:i)&&(n=o),i;if(this.editorDocument.selection){if(!(t=this.editorDocument.selection.createRange()).duplicate)return null;n=t.parentElement();var r=t.duplicate(),a=t.duplicate();return r.collapse(!0),a.moveToElementText(r.parentElement()),a.setEndPoint("EndToStart",r),o=r.parentElement(),r=t.duplicate(),(a=t.duplicate()).collapse(!1),r.moveToElementText(a.parentElement()),r.setEndPoint("StartToEnd",a),i=a.parentElement(),(o="body"==o.nodeName.toLowerCase()?o.firstChild:o)==(i="body"==i.nodeName.toLowerCase()?i.lastChild:i)&&(n=o),i}}catch(e){return null}return null},_addHandlers:function(){function t(){d._textArea&&!d.updating&&(d._textArea.value=d.val()),d.changed&&(d._raiseEvent("change"),d.changed=!1),d.focused=!1,d.inline&&(d.host.removeClass(d.toThemeProperty("jqx-fill-state-focus")),d.host.removeClass(d.toThemeProperty("jqx-editor-inline-focus")),""!=d.tools&&null!=d.tools&&d.toolbarContainer.fadeOut("fast"))}function l(){var e;d.focused=!0,d.inline&&(d.host.addClass(d.toThemeProperty("jqx-fill-state-focus")),d.host.addClass(d.toThemeProperty("jqx-editor-inline-focus")),d.host.addClass(d.toThemeProperty("jqx-rc-all")),""!=d.tools&&null!=d.tools&&(d.toolbarContainer.fadeIn("fast"),e=d.host.coord(),"bottom"!=d.toolbarPosition?d.toolbarContainer.offset({left:e.left,top:e.top-d.toolbarContainer.outerHeight()-5}):d.toolbarContainer.offset({left:e.left,top:e.top+5+d.host.height()})))}var d=this;d.addHandler(d.toolbar,"mousedown.editor"+d.element.id,function(e){return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1});v.jqx.browser.mozilla&&this.addHandler(v(document),"mousedown.editor"+d.element.id,function(e){t()}),d.addHandler(d.editor,"blur.editor"+d.element.id,function(e){t()}),d.addHandler(d.editor,"focus.editor"+d.element.id,function(e){l()}),d.addHandler(d.editor,"beforedeactivate.editor"+d.element.id,function(e){d.range=d.getRange()}),d.addHandler(d.editor,"mousedown.editor"+d.element.id,function(e){e.target.href||d.linkPopup&&d.linkPopup.remove(),d.range=d.getRange(),v.jqx.browser.mozilla&&(l(),e.stopPropagation()),0<v(".jqx-editor-dropdownpicker").length&&v(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),0<v(".jqx-editor-dropdownlist").length&&v(".jqx-editor-dropdownlist").jqxDropDownList("close"),d.inline&&d.editor.focus()}),v.jqx.mobile.isTouchDevice()&&(d.addHandler(v(d.editorDocument),"selectionchange.editor"+d.element.id,function(){d.editorDocument.activeElement!=d.editor[0]&&setTimeout(function(){d.iframe&&d.iframe[0].contentWindow.focus()},500)}),d.addHandler(v(d.editorDocument),"touchstart.editor"+d.element.id,function(){setTimeout(function(){d.iframe&&d.iframe[0].contentWindow.focus()},500)})),d.addHandler(d.editor,"mouseup.editor"+d.element.id,function(e){if("source"==d._documentMode)return!0;d.range=d.getRange(),d._refreshTools(null,!0)}),d.addHandler(d.editor,"keydown.editor"+d.element.id,function(e){if(d.keyPressed&&d.keyPressed(e),"source"==d._documentMode)return!0;if(!v.jqx.browser.mozilla||d.focused||l(),d.changeType="keyboard",d.disabled)return e.preventDefault&&e.preventDefault(),!1;if(d.updating)return d.activeElement&&(o=v.Event("keydown"),v.extend(o,e),d.activeElement.trigger(o)),e.preventDefault&&e.preventDefault(),!1;var t=e||window.event,o=t.keyCode,i=String.fromCharCode(o).toLowerCase();if(d.editable||(-1!=v.inArray(t.keyCode,[9,33,34,35,36,37,38,39,40,40,45])||t.ctrlKey&&"c"==i||t.ctrlKey&&"a"==i||e.preventDefault()),!(0<d.selection.getText().length||d.linkPopup)||-1==!v.inArray(t.keyCode,[8,9,13,33,34,35,36,37,38,39,40,40,45,46])&&(65!=t.keyCode||!t.ctrlKey||t.altKey||t.shiftKey)||(d._refreshToolsTimer&&clearTimeout(d._refreshToolsTimer),d._refreshToolsTimer=setTimeout(function(){d._refreshTools(null,!0,t.keyCode)},10)),13==o&&"default"!=d.lineBreak){var n,o=d.getSelectedElement();if(o){switch(o.nodeName.toLowerCase()){case"pre":case"li":case"ul":case"ol":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return!0}for(var r=o;null!=r;){if("#document"==r.nodeName){r=d.editorDocument.body;break}if(r.parentNode==d.editorDocument.body||r==d.editorDocument.body)break;r=r.parentNode}}if(r)return o=d.getRange(),"<div></div>"==d.editorDocument.body.innerHTML&&"br"!=d.lineBreak&&d.selection.insertContent("&#8203;"),"div"==d.lineBreak?r==d.editorDocument.body?v(r).append("<div>&#8203;</div><span id='INSERTION_MARKER'>&nbsp;</span>"):v("<div>&#8203;</div><span id='INSERTION_MARKER'>&nbsp;</span>").insertAfter(r):"p"==d.lineBreak?r==d.editorDocument.body?v(r).append("<p>&#8203;</p><span id='INSERTION_MARKER'>&nbsp;</span>"):v("<p>&#8203;</p><span id='INSERTION_MARKER'>&nbsp;</span>").insertAfter(r):d.execute("insertHTML","<br/>&#8203;<span id='INSERTION_MARKER'>&nbsp;</span>"),d.selectRange(o),n=v(d.editorDocument).find("#INSERTION_MARKER"),"br"!=d.lineBreak?d.selection.selectNode(v(n).prev()[0],!0):(d.selection.selectNode(n[0],!0),d.getRange().setStartAfter&&d.getRange().setStartAfter(n[0])),n.remove(),d.selection.collapse(!1),r&&r.nodeName&&"br"==d.lineBreak&&"#text"!=r.nodeName.toLowerCase()&&(d.selection.selectNode(r,!0),d.getRange().setStartAfter&&d.getRange().setStartAfter(r),d.selection.collapse(!1)),"br"!=d.lineBreak&&(o=d.getRange()).select&&o.select(),e.preventDefault&&e.preventDefault(),!1}if(t.ctrlKey&&("k"==i||"u"==i||"b"==i||"i"==i)){e.preventDefault&&e.preventDefault();var a=null;switch(i){case"k":a="link";break;case"u":a="underline";break;case"b":a="bold";break;case"i":a="italic"}return d.commands[a].widget&&d.commands[a].widget.trigger("click"),!1}}),d.addHandler(d.editor,"paste.editor"+d.element.id,function(e){if("source"==d._documentMode)return!0;if(d.readOnly)return!0;d.updating=!0,d.readOnly=!0;try{var t,o,l=d.getRange(),i=("text"!=d.pasteMode||v.jqx.browser.mozilla?d.selection.insertContent('<div class="jqx-editor-paste-element">&nbsp;</div>'):d.selection.insertContent('<textarea cols="50" contenteditable="false" class="jqx-editor-paste-element"></textarea>'),v(window).scrollTop()),n=v(d.editorDocument).find(".jqx-editor-paste-element");n.css("top",i+"px"),d.editor[0].createTextRange?(e.preventDefault(),(t=d.editor[0].createTextRange()).moveToElementText(n[0]),t.execCommand("Paste")):((o=d.editorDocument.createRange()).selectNodeContents(n[0]),d.selectRange(o)),"text"!=d.pasteMode||v.jqx.browser.mozilla||n.select(),d.marker=n,setTimeout(function(){d.selectRange(l);function e(e){var t=d.editorDocument.createElement("div"),o=d.editorDocument.createDocumentFragment();for(t.innerHTML=e;t.firstChild;)o.appendChild(t.firstChild);return o}if("text"!=d.pasteMode){var t=e(d.marker.html());if(t.firstChild&&"jqx-editor-paste-element"===t.firstChild.className){for(var o=[],i=0,n=t.childNodes.length;i<n;i++)o.push(t.childNodes[i].innerHTML);t=e(o.join("<br />"))}var r=document.createElement("div"),r=(r.appendChild(t.cloneNode(!0)),r.innerHTML)}else{r=d.marker.val();""!=d.marker.html()&&-1==d.marker.val().indexOf("\n")&&(r=(r=(r=(r=(r=(r=d.marker.html()).replace(/&nbsp;/gm,"")).replace(/\n\n/gm,"\n")).replace(/<br[^>]*>/gi,"\n")).replace(/<li[^>]*>/gi,"\n")).replace(/<p[^>]*>/gi,"\n"),d.marker.html(r),r=d.marker.text())}r=r,a="text"==d.pasteMode;var a=r=a?d.paragraphise?(r=(r="<p>"+r+"</p>").replace(/\n/g,"</p><p>")).replace(/<p>\s<\/p>/gi,""):r.replace(/\n/g,"<br />"):((r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=r.replace(/<html[^>]*?>(.*)/gim,"$1")).replace(/<\/html>/gi,"")).replace(/<body[^>]*?>(.*)/gi,"$1")).replace(/<\/body>/gi,"")).replace(/<style[^>]*?>[\s\S]*?<\/style[^>]*>/gi,"")).replace(/<(?:meta|link)[^>]*>\s*/gi,"")).replace(/<\\?\?xml[^>]*>/gi,"")).replace(/<w:[^>]*>[\s\S]*?<\/w:[^>]*>/gi,"")).replace(/<o:p>\s*<\/o:p>/g,"")).replace(/<o:p>[\s\S]*?<\/o:p>/g,"&nbsp;")).replace(/<\/?\w+:[^>]*>/gi,"")).replace(/<\!--[\s\S]*?-->/g,"")).replace(/<\!\[[\s\S]*?\]>/g,"")).replace(/\s*mso-[^:]+:[^;"']+;?/gi,"")).replace(/<(\w[^>]*) style='([^\']*)'([^>]*)/gim,"<$1$3")).replace(/<(\w[^>]*) style="([^\"]*)"([^>]*)/gim,"<$1$3")).replace(/\s*margin: 0cm 0cm 0pt\s*;/gi,"")).replace(/\s*margin: 0cm 0cm 0pt\s*"/gi,'"')).replace(/\s*text-indent: 0cm\s*;/gi,"")).replace(/\s*text-indent: 0cm\s*"/gi,'"')).replace(/\s*text-align: [^\s;]+;?"/gi,'"')).replace(/\s*page-break-before: [^\s;]+;?"/gi,'"')).replace(/\s*font-variant: [^\s;]+;?"/gi,'"')).replace(/\s*tab-stops:[^;"']*;?/gi,"")).replace(/\s*tab-stops:[^"']*/gi,"")).replace(/\s*face="[^"']*"/gi,"")).replace(/\s*face=[^ >]*/gi,"")).replace(/\s*font-family:[^;"']*;?/gi,"")).replace(/\s*font-size:[^;"']*;?/gi,"")).replace(/<(\w[^>]*) class=([^ |>]*)([^>]*)/gi,"<$1$3")).replace(/<(\w+)[^>]*\sstyle="[^"']*display\s?:\s?none[\s \S]*?<\/\1>/gi,"")).replace(/\s*style='\s*'/gi,"")).replace(/\s*style="\s*"/gi,"")).replace(/<span\s*[^>]*>\s*&nbsp;\s*<\/span>/gi,"&nbsp;")).replace(/<span\s*[^>]*><\/span>/gi,"")).replace(/<(\w[^>]*) align=([^ |>]*)([^>]*)/gi,"<$1$3")).replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"<$1$3")).replace(/<span([^>]*)>([\s\S]*?)<\/span>/gi,"$2")).replace(/<font\s*>([\s\S]*?)<\/font>/gi,"$1")).replace(/<(u|i|strike)>&nbsp;<\/\1>/gi,"&nbsp;")).replace(/<h\d>\s*<\/h\d>/gi,"")).replace(/<(\w[^>]*) language=([^ |>]*)([^>]*)/gi,"<$1$3")).replace(/<(\w[^>]*) onmouseover="([^\"']*)"([^>]*)/gi,"<$1$3")).replace(/<(\w[^>]*) onmouseout="([^\"']*)"([^>]*)/gi,"<$1$3")).replace(/<h(\d)([^>]*)>/gi,"<h$1>")).replace(/<(h\d)><font[^>]*>([\s\S]*?)<\/font><\/\1>/gi,"<$1>$2</$1>")).replace(/<(h\d)><em>([\s\S]*?)<\/em><\/\1>/gi,"<$1>$2</$1>")).replace(/<b\b[^>]*>(.*?)<\/b[^>]*>/gi,"<strong>$1</strong>")).replace(/<i\b[^>]*>(.*?)<\/i[^>]*>/gi,"<em>$1</em>")).replace(/<\s+[^>]*>/gi,"")).replace(/<span>([\s\S]*?)<\/span>/gi,"$1")).replace(/<span>([\s\S]*?)<\/span>/gi,"$1")).replace(/<div>([\s\S]*?)<\/div>/gi,"$1")).replace(/<div>([\s\S]*?)<\/div>/gi,"$1")).replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"")).replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"")).replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"")).trim&&(r=r.trim()),d.paragraphise?"<p"!==r.substr(0,2)&&(r=(r=(r="<p>"+r+"</p>").replace(/\n/g,"</p><p>")).replace(/<br[^>]*>/gi,"</p><p>")):(r.replace(/<p>/gi,"<br />"),r.replace(/<\/p>/gi,"")),(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=r.replace(/<br>/gi,"<br />")).replace(/<br[^>]*><\/p>/gim,"</p>")).replace(/<p>&nbsp;<\/p>/gi,"")).replace(/<p>\s<\/p>/gi,"")).replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"")).replace(/MsoNormal/gi,"")).replace(/<\/?meta[^>]*>/gi,"")).replace(/<\/?xml[^>]*>/gi,"")).replace(/<\?xml[^>]*\/>/gi,"")).replace(/<!--(.*)-->/gi,"")).replace(/<!--(.*)>/gi,"")).replace(/<!(.*)-->/gi,"")).replace(/<w:[^>]*>(.*)<\/w:[^>]*>/gi,"")).replace(/<w:[^>]*\/>/gi,"")).replace(/<\/?w:[^>]*>/gi,"")).replace(/<m:[^>]*\/>/gi,"")).replace(/<m:[^>]>(.*)<\/m:[^>]*>/gi,"")).replace(/<o:[^>]*>(.*)<\/o:[^>]*>/gi,"")).replace(/<o:[^>]*\/>/gi,"")).replace(/<\/?m:[^>]*>/gi,"")).replace(/style=\"([^>]*)\"/gi,"")).replace(/style=\'([^>]*)\'/gi,"")).replace(/class=\"(.*)\"/gi,"")).replace(/class=\'(.*)\'/gi,"")).replace(/<b>/gi,"<strong>")).replace(/<\/b>/gi,"</strong>")).replace(/<p[^>]*>/gi,"<p>")).replace(/<\/p[^>]*>/gi,"</p>")).replace(/<span[^>]*>/gi,"")).replace(/<\/span[^>]*>/gi,"")).replace(/<st1:[^>]*>/gi,"")).replace(/<\/st1:[^>]*>/gi,"")).replace(/<font[^>]*>/gi,"")).replace(/<\/font[^>]*>/gi,"")).replace("  ","")).replace(/<strong><\/strong>/gi,"")).replace(/<p><\/p>/gi,"")).replace(/\/\*(.*)\*\//gi,"")).replace(/<!--/gi,"")).replace(/-->/gi,"")).replace(/<style[^>]*>[^<]*<\/style[^>]*>/gi,"")).trim()),a=(d.getRange(),d.selection.insertContent(a+"<span id='INSERTION_MARKER'>&nbsp;</span>"),d.marker.remove(),v(d.editorDocument).find("#INSERTION_MARKER"));d.selection.selectNode(a[0],!0),d.getRange().setStartAfter&&d.getRange().setStartAfter(a[0]),a.remove(),d.selection.collapse(!1),a.removeAttr("id"),d._refreshTools(),d.changed=!0},100),d.updating=!1,d.readOnly=!1}catch(e){console&&console.log(e)}}),d.addHandler(d.editor,"keyup.editor"+d.element.id,function(e){if("source"==d._documentMode)return!0;if(d.updating||d.disabled||!d.editable)return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1;d.range=d.getRange(),d.changed=!0;e=e||window.event;e.keyCode;-1==v.inArray(e.keyCode,[8,9,13,33,34,35,36,37,38,39,40,40,45,46])&&(65!=e.keyCode||!e.ctrlKey||e.altKey||e.shiftKey)||d._refreshTools(null,!0,e.keyCode)}),d.addHandler(d.editor,"click.editor"+d.element.id,function(e){if("source"==d._documentMode)return!0;d.editImage&&(v(d.editImage).removeClass("jqx-editor-focus"),d.editImage=null),"img"==e.target.tagName.toLowerCase()&&(e=e.target,d.editImage=e,v(d.editImage).addClass("jqx-editor-focus"))}),d.addHandler(d.editor,"dblclick.editor"+d.element.id,function(e){if("source"==d._documentMode)return!0;"img"==e.target.tagName.toLowerCase()&&(e=e.target,0<v("#imageWindow"+this.element.id).length&&(d.editImage=e,d._updateImageWindow()))})},_updateLinkWindow:function(){var e=this,t=v("#linkWindow"+this.element.id),o=(t.jqxWindow({position:{center:e.widget}}),t.jqxWindow("open"),t.find("input")),i=t.find(".jqx-editor-link-checkbox"),n=t.find("button:first"),t=v(t.find("button")[1]);e.editLink&&e.editLink.href?(o[0].value=e.editLink.href||"",o[1].value=v(e.editLink).text()||e.editLink.href,i.val("_blank"==v(e.editLink).attr("target")),t.show()):(o[0].value="",o[1].value="",e.selection.isCollapsed()||((e=e.selection.getText()).match(/^(?!:\/\/)([a-zA-Z0-9]+\.)?[a-zA-Z0-9][a-zA-Z0-9-]+\.[a-zA-Z]{2,6}?$/i)?o[0].value=e:o[1].value=e),i.val(!1),t.hide()),0<o[0].value.length?n.jqxButton({disabled:!1}):n.jqxButton({disabled:!0})},_updateImageWindow:function(){var e=(e=this.editImage)||v("<img>")[0],t=v("#imageWindow"+this.element.id),o=(t.jqxWindow({position:{center:this.widget}}),t.jqxWindow("open"),t.find("input")),i=v(t.find("button")[1]),i=(this.editImage?i.show():i.hide(),o[0].value=e.src,""==o[0].value&&(o[0].value=""),o[1].value=e.alt,"auto"!=e.style.width?o[2].value=e.style.width:o[2].value="","auto"!=e.style.height?o[3].value=e.style.height:o[3].value="",e.style.marginLeft&&"0px"!=e.style.marginLeft?o[4].value=e.style.marginLeft:o[4].value="",e.style.marginTop&&"0px"!=e.style.marginTop?o[5].value=e.style.marginTop:o[5].value="",t.find(".jqx-editor-align")),o=v(e).css("float");"left"==o?i.jqxDropDownList({selectedIndex:1}):"right"==o?i.jqxDropDownList({selectedIndex:2}):i.jqxDropDownList({selectedIndex:0})},_removeHandlers:function(){var e=this;e.editor&&(e.removeHandler(e.editor,"paste.editor"+e.element.id),e.removeHandler(e.editor,"blur.editor"+e.element.id),e.removeHandler(e.editor,"focus.editor"+e.element.id),e.removeHandler(e.editor,"click.editor"+e.element.id),e.removeHandler(e.editor,"mousedown.editor"+e.element.id),e.removeHandler(e.editor,"mouseup.editor"+e.element.id),e.removeHandler(e.editor,"keyup.editor"+e.element.id),e.removeHandler(e.editor,"keydown.editor"+e.element.id),e.removeHandler(e.editor,"beforedeactivate.editor"+e.element.id),e.removeHandler(e.editor,"dblclick.editor"+e.element.id)),e.toolbar&&e.removeHandler(e.toolbar,"mousedown.editor"+e.element.id)},getParentByTag:function(e,t){var t=t.toLowerCase(),o=e;do{if(""==t||o.nodeName.toLowerCase()==t)return o}while(o=o.parentNode);return e},isStyleProperty:function(e,t,o,i){var t=t.toLowerCase(),n=e;do{if(n.nodeName.toLowerCase()==t&&n.style[o]==i)return!0}while(n=n.parentNode);return!1},setStyleProperty:function(e,t){this.style[t]=!1;var o=this.getParentByTag(e,t);o&&o.tagName.toLowerCase()==t&&(this.style[t]=!0),"del"==t&&this.getParentByTag(e,"strike")&&"strike"==this.getParentByTag(e,"strike").tagName.toLowerCase()&&(this.style.del=!0)},updateStyle:function(e){var t,o,i=this;if((e=i.getSelectedElement()?i.getSelectedElement():e)&&i.setStyleProperty)try{window.getComputedStyle?("#text"==e.nodeName.toLowerCase()&&(e=i.editor[0]),t=401==(o=window.getComputedStyle(e,null)).getPropertyValue("font-weight")?700:o.getPropertyValue("font-weight"),i.style={fontStyle:o.getPropertyValue("font-style"),fontSize:o.getPropertyValue("font-size"),textDecoration:o.getPropertyValue("text-decoration"),fontWeight:t,fontFamily:o.getPropertyValue("font-family"),textAlign:o.getPropertyValue("text-align"),color:i._rgbToHex(o.color),backColor:i._rgbToHex(o.backgroundColor)},i.style.fontStyle=o.getPropertyValue("font-style"),i.style.vAlign=o.getPropertyValue("vertical-align"),i.style.del=i.isStyleProperty(e,"span","textDecoration","line-through"),i.style.u=i.isStyleProperty(e,"span","textDecoration","underline"),i.style.backColor||(i.style.backColor=i._rgbToHex(function(e){for(var t="transparent";e&&(window.getComputedStyle(e).backgroundColor==t||"rgba(0, 0, 0, 0)"==window.getComputedStyle(e).backgroundColor);)e=e.parentNode;return e?window.getComputedStyle(e).backgroundColor:t}(e)))):(o=e.currentStyle,i.style={fontStyle:o.fontStyle,fontSize:o.fontSize,textDecoration:o.textDecoration,fontWeight:o.fontWeight,fontFamily:o.fontFamily,textAlign:o.textAlign,color:i._rgbToHex(o.color),backColor:i._rgbToHex(o.backgroundColor)}),i.setStyleProperty(e,"h1"),i.setStyleProperty(e,"h2"),i.setStyleProperty(e,"h3"),i.setStyleProperty(e,"h4"),i.setStyleProperty(e,"h5"),i.setStyleProperty(e,"h6"),i.setStyleProperty(e,"del"),i.setStyleProperty(e,"sub"),i.setStyleProperty(e,"sup"),i.setStyleProperty(e,"u"),"a"==e.nodeName.toLowerCase()&&"underline"==i.style.textDecoration&&(i.style.u=!0),(i.style.h1||i.style.h2||i.style.h3||i.style.h4||i.style.h5||i.style.h6)&&(i.style.heading=!0)}catch(e){return null}},_refreshTools:function(g,p,e){var h=this;if(!h.updating&&((g=h.getSelectedElement()?h.getSelectedElement():g)&&h.setStyleProperty)){h.updateStyle(g);var t=h.readOnly;if(!(h.readOnly=!0)!==h.tools){function o(e){v.each(e,function(e,t){var o=h.commands[this];if(!o)return!0;switch(o.type){case"list":o.widget.jqxDropDownList("clearSelection"),o.widget.jqxDropDownList({disabled:h.disabled});break;case"colorPicker":o.val(o.value),o.widget.jqxDropDownButton({disabled:h.disabled});break;case"toggleButton":o.widget.jqxToggleButton("unCheck"),o.widget.jqxToggleButton({disabled:h.disabled});break;default:o.widget.jqxButton({disabled:h.disabled})}})}var i=h.tools.split(" "),n=h.tools.split(" | ");if(0==n.length)o(i);else for(var r=0;r<n.length;r++)o(i=n[r].split(" "));if(h.style){function a(e){v.each(e,function(e,t){var o=h.commands[this];if(!o)return!0;if(o.refresh)return o.refresh(o.widget,h.style),!0;switch(o.type){case"list":if("fontname"==o.command){for(var i=-1,n=999,r=0;r<o.value.length;r++){var t=o.value[r].label.toLowerCase(),a=h.style.fontFamily.toLowerCase().indexOf(t);0<=a&&(a<n&&(i=r),n=Math.min(n,a))}o.widget.jqxDropDownList("selectIndex",i)}else if("formatblock"==o.command){t=null;h.style.h1?t="h1":h.style.h2?t="h2":h.style.h3?t="h3":h.style.h4?t="h4":h.style.h5?t="h5":h.style.h6&&(t="h6"),o.widget.jqxDropDownList("selectItem",t)}else if("fontsize"==o.command){var l="xx-small,x-small,small,medium,large,x-large,xx-large".split(","),d=-1;try{-1==(d=g.getAttribute("size")-1)&&(d=h.editorDocument.queryCommandValue(o.command)-1)}catch(e){}l=l[d];o.widget.val(l)}break;case"colorPicker":l="number"!=typeof(d=h.editorDocument.queryCommandValue(o.command))?d:"rgb("+(255&d)+", "+((65280&d)>>8)+", "+((16711680&d)>>16)+")",l=("backcolor"==o.command&&null==h.style.backColor&&(l="#FFFFFF"),h._rgbToHex(l));l?o.val(l):"forecolor"==o.command?o.val(h.style.color):"backcolor"==o.command&&o.val(h.style.backColor);break;case"toggleButton":if("viewsource"==o.command)return;if(!o.command)return;var s,c=!1,l=h.editorDocument.queryCommandState(o.command)&&h.editorDocument.queryCommandEnabled(o.command),u=("createlink"==o.command&&"a"==g.nodeName.toLowerCase()&&(u=!0,(u=-1==v(g).text().indexOf(h.selection.getText())&&""!=h.selection.getText()?!1:u)&&(h.linkPopup&&h.linkPopup.remove(),l=!0,h.linkPopup=v("<div class='jqx-editor-link-popup' contentEditable='false' style='overflow: hidden; white-space: nowrap; padding: 5px; height: 17px; font-size: 12px; color: #222222; background: #F5F5F5; position: absolute; z-index: 9999;'>"+h.localization["Go to link"]+": <a target='_blank' style='color:#222222;' href='"+g.href+"'>"+g.href+"</a> - <a style='color:#222222;' href='#change'>"+h.localization.Change+"</a> - <a style='color:#222222;' href='#remove'>"+h.localization.Remove+"</a></div>").appendTo(h.editor),s=(u=v(g).coord()).left,u.left+h.linkPopup.width()>h.editor.width()&&(s=h.editor.width()-h.linkPopup.width()-15),h.linkPopup.offset({top:v(g).height()+u.top+5,left:s}),h.addHandler(h.linkPopup,"mousedown",function(e){if(e.target&&e.target.href)switch(v(e.target).index()){case 1:h.editor.focus(),h.selection.selectNode(g,!0),h.commands.link.widget.trigger("click");break;case 2:try{h.editor.focus(),h.selection.selectNode(g),h.execute("unlink"),h.commands.underline.toggled=!1,h.selection.collapse(!1),h._refreshTools()}catch(e){}break;default:window.open(e.target.href,"_blank")}return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}))),"bold"==o.command?(h.style.fontWeight&&(600<=h.style.fontWeight||"bold"==h.style.fontWeight)&&(c=!0),h.selection.isCollapsed()?o.toggled=l:o.toggled=l||c,l=o.toggled):"italic"==o.command?(h.style.fontStyle&&"italic"==h.style.fontStyle&&(c=!0),p?o.toggled=l:l=o.toggled):"underline"==o.command?(h.style.u&&(c=!0),p?o.toggled=l:l=o.toggled):"justifyleft"==o.command?"left"==h.style.textAlign&&(c=!0):"justifyright"==o.command?"right"==h.style.textAlign&&(c=!0):"justifycenter"==o.command?"center"==h.style.textAlign&&(c=!0):"justifyfull"==o.command?"justify"==h.style.textAlign&&(c=!0):v.each(h.style,function(e,t){o.command==e.toLowerCase()&&(c=!0)}),l);(c&&-1!=o.command.indexOf("justify")||u||c&&!1===h.range.collapsed||v.jqx.browser.msie&&v.jqx.browser.version<9&&c&&!h.selection.isCollapsed())&&o.widget.jqxToggleButton("check");break;default:o.refresh&&o.refresh(o.widget,h.style)}})}if(0==n.length)a(i);else for(r=0;r<n.length;r++)a(i=n[r].split(" "))}}h.readOnly=t}},_rgbToHex:function(e){if(e){if("#"===e.substr(0,1))return 4==e.length?"#"+(t=e.substr(1,1))+t+(o=e.substr(2,1))+o+(i=e.substr(3,1))+i:e;e=/(.*?)rgb\((\d+),\s*(\d+),\s*(\d+)\)/i.exec(e);if(!e)return null;var t=parseInt(e[2],10).toString(16),o=parseInt(e[3],10).toString(16),i=parseInt(e[4],10).toString(16);return"#"+((1==t.length?"0"+t:t)+(1==o.length?"0"+o:o)+(1==i.length?"0"+i:i))}return null},_preventDefault:function(e,t){!1!==t&&(0<v(".jqx-editor-dropdownpicker").length&&v(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),0<v(".jqx-editor-dropdownlist").length&&v(".jqx-editor-dropdownlist").jqxDropDownList("close")),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.returnValue=!1},_addCommandHandler:function(e,t,o,i,n){var r,a=this;switch(o=!o&&n.init?"custom":o){case"custom":switch(n.type){case"list":r=function(e){"source"!=a._documentMode&&"none"!=e.args.type&&(n.value=v(this).val(),a.execute("custom",n),a.readOnly||a._refreshTools()),a._preventDefault(e,!1)};break;case"colorPicker":r=function(e){var t;return"source"!=a._documentMode&&(v(n.colorPicker).find("td").removeClass("jqx-editor-color-picker-selected-cell"),"div"==e.target.nodeName.toLowerCase()?(t=v(e.target).css("background-color"),v(e.target).parent().addClass("jqx-editor-color-picker-selected-cell")):(t=v(e.target).find("div").css("background-color"),v(e.target).addClass("jqx-editor-color-picker-selected-cell")),v("#bar-"+o).css("background",t),n.widget.val=function(){var e="number"!=typeof(e=t)?e:"rgb("+(255&e)+", "+((65280&e)>>8)+", "+((16711680&e)>>16)+")";return a._rgbToHex(e)},n.widget.jqxDropDownButton("close"),a.execute("custom",n)),a._preventDefault(e),!1};break;default:r=function(e){0<v(".jqx-editor-dropdownpicker").length&&v(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),0<v(".jqx-editor-dropdownlist").length&&v(".jqx-editor-dropdownlist").jqxDropDownList("close"),a._preventDefault(e);v(this).attr("data-command");return"source"!=a._documentMode&&(n.toggle&&n.toggle(),a.execute("custom",n),a._refreshTools()),!1}}break;case"formatblock":r=function(e){"source"!=a._documentMode&&"none"!=e.args.type&&(a.execute(v(this).attr("data-command"),"<"+v(this).val()+">",n),a.readOnly||(a.commands.bold.toggled=!1,a._refreshTools())),a._preventDefault(e,!1)};break;case"fontsize":r=function(e){var t,o,i;"source"!=a._documentMode&&"none"!=e.args.type&&(t=v(this).val(),o="xx-small,x-small,small,medium,large,x-large,xx-large".split(","),i=v(this).jqxDropDownList("getSelectedIndex")+1,i=1+o.indexOf(t),a.execute(v(this).attr("data-command"),i,n)),a._preventDefault(e,!1)};break;case"fontname":r=function(e){var t;"source"!=a._documentMode&&"none"!=e.args.type&&(t=v(this).val(),a.execute(v(this).attr("data-command"),t,n)),a._preventDefault(e,!1)};break;case"forecolor":case"backcolor":r=function(e){var t;return"source"!=a._documentMode&&(v(n.colorPicker).find("td").removeClass("jqx-editor-color-picker-selected-cell"),"div"==e.target.nodeName.toLowerCase()?(t=v(e.target).css("background-color"),v(e.target).parent().addClass("jqx-editor-color-picker-selected-cell")):(t=v(e.target).find("div").css("background-color"),v(e.target).addClass("jqx-editor-color-picker-selected-cell")),v("#bar-"+o).css("background",t),n.widget.jqxDropDownButton("close"),a.execute(o,t,n)),a._preventDefault(e),!1};break;case"viewsource":r=function(e){return a.linkPopup&&a.linkPopup.remove(),n.toggle(),a.setMode(n.toggled),0<v(".jqx-editor-dropdownpicker").length&&v(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),0<v(".jqx-editor-dropdownlist").length&&v(".jqx-editor-dropdownlist").jqxDropDownList("close"),a._preventDefault(e),!1};break;case"insertimage":r=function(e){a._insertImageAction(e,a,n)};break;case"createlink":r=function(e){a._createLinkAction(e,a,n)};break;default:r=function(e){0<v(".jqx-editor-dropdownpicker").length&&v(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),0<v(".jqx-editor-dropdownlist").length&&v(".jqx-editor-dropdownlist").jqxDropDownList("close"),a._preventDefault(e);e=v(this).attr("data-command");if("source"!=a._documentMode){if("underline"==e&&a.getSelectedElement()){var t=a.getSelectedElement();if(t&&"a"==t.nodeName.toLowerCase())return n.toggled?v(t).css("text-decoration","none"):v(t).css("text-decoration","underline"),n.toggle(),a._refreshTools(),!1}n.toggle&&n.toggle(),a.execute(e,v(this).val(),n),a._refreshTools()}return!1}}return a.addHandler(e,t,r),!1},_createLinkAction:function(e,i,n){if("source"!=(i=this)._documentMode){i.focused||i.editor.focus(),i.range=i.getRange();var t=i.getSelectedElement();if("a"==t.nodeName.toLowerCase()?i.editLink=t:i.editLink=null,0<v("#linkWindow"+this.element.id).length)return i.editLink&&i.selection.selectNode(t,!0),i._updateLinkWindow(),i._preventDefault(e),!1;var r=v("<div class='jqx-editor-window jqx-editor-link-window'><div>"+i.localization["Insert Link"]+"</div><div><table style='border-collapse: separate; border-spacing: 2px;'><tr><td align='right'>"+i.localization.URL+":</td><td><input style='width: 200px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+i.localization.Title+":</td><td><input style='width: 200px; height: 23px;' value=''/></td><tr/><tr><td align='right'></td><td><div class='jqx-editor-link-checkbox'>"+i.localization["Open in a new window/tab"]+"</div></td><tr/><tr><td align='right'></td><td align='right'><button>Ok</button><button style='margin-left: 5px;'>Remove</button><button style='margin-left: 5px;'>Cancel</button></td><tr/></table></div></div>"),o=(r[0].id="linkWindow"+this.element.id,r.find("input")),a=(o.addClass(i.toThemeProperty("jqx-widget")),o.addClass(i.toThemeProperty("jqx-widget-content")),o.addClass(i.toThemeProperty("jqx-input")),r.find(".jqx-editor-link-checkbox").jqxCheckBox({theme:i.theme,height:23,width:180})),l=r.find("button:first").jqxButton({theme:i.theme,disabled:!0}),t=v(r.find("button")[1]).jqxButton({theme:i.theme}),d=r.find("button:last").jqxButton({theme:i.theme}),s=(l.val(i.localization.Ok),d.val(i.localization.Cancel),t.val(i.localization.Remove),i.addHandler(d,v.jqx.mobile.isTouchDevice()?v.jqx.mobile.getTouchEventName("touchstart"):"click",function(e){i.editor.focus(),i.selectRange(i.range),i._refreshTools(),i._preventDefault(e)}),i.editLink&&(!i.editLink||i.editLink.href)||t.hide(),!1);return i.addHandler(v(o[0]),"focus",function(){s=""==o[1].value||o[1].value==o[0].value}),i.addHandler(v(o[1]),"keyup",function(e){e.keyCode&&(13==e.keyCode&&l.trigger("click"),27==e.keyCode&&d.trigger("click"))}),i.addHandler(v(o[0]),"keyup change",function(e){0<o[0].value.length?l.jqxButton({disabled:!1}):l.jqxButton({disabled:!0}),s&&(o[1].value=o[0].value),e.keyCode&&(13==e.keyCode&&l.trigger("click"),27==e.keyCode&&d.trigger("click"))}),i.addHandler(t,v.jqx.mobile.isTouchDevice()?v.jqx.mobile.getTouchEventName("touchstart"):"click",function(e){r.jqxWindow("close");try{i.editor.focus(),i.selection.selectNode(i.editLink),i.execute("unlink"),i.selection.collapse(!1),i.commands.underline.toggled=!1,i._refreshTools()}catch(e){}i._preventDefault(e)}),i.addHandler(l,v.jqx.mobile.isTouchDevice()?v.jqx.mobile.getTouchEventName("touchstart"):"click",function(e){var t=r.find("input"),o=v("<a>"+(t[1].value||t[0].value)+"</a>"),t=(a.val()&&o.attr("target","_blank"),o[0].href=v.trim(t[0].value),-1==t[0].value.indexOf("http")&&-1==t[0].value.indexOf("mailto")&&(o[0].href="https://"+v.trim(t[0].value)),i.focused||i.editor.focus(),i.range&&i.selectRange(i.range),i.editLink&&v(i.editLink).remove(),i.execute("insertHTML",o[0].outerHTML+"<span id='INSERTION_MARKER'>&nbsp;</span>",n),i.editor.focus(),v(i.editorDocument).find("#INSERTION_MARKER"));i.selection.selectNode(t[0],!0),i.getRange().setStartAfter&&i.getRange().setStartAfter(t[0]),t.remove(),i.selection.collapse(!1),i._refreshTools(),i._preventDefault(e)}),i.updating=!0,r.appendTo(document.body),i.addHandler(r,"open",function(){i.updating=!0,setTimeout(function(){i.range=i.getRange(),v(o[0]).focus()},25)}),r.jqxWindow({resizable:!1,width:280,okButton:l,cancelButton:d,theme:i.theme,isModal:!0,position:{center:i.widget}}),i.addHandler(r,"close",function(){i.updating=!1}),i.focused||(i.editor.focus(),i.selectRange(i.range)),i.editLink?(o[0].value=i.editLink.href||"",o[1].value=v(i.editLink).text(),a.val("_blank"==v(i.editLink).attr("target"))):i.selection.isCollapsed()||((t=i.selection.getText()).match(/^(?!:\/\/)([a-zA-Z0-9]+\.)?[a-zA-Z0-9][a-zA-Z0-9-]+\.[a-zA-Z]{2,6}?$/i)?o[0].value=t:o[1].value=t),0<o[0].value.length?l.jqxButton({disabled:!1}):l.jqxButton({disabled:!0}),i._preventDefault(e),!1}i._preventDefault(e)},_insertImageAction:function(e,i,n){if("source"!=i._documentMode){if(i.focused||i.editor.focus(),i.range=i.getRange(),0<v("#imageWindow"+this.element.id).length)return i._updateImageWindow(),i._preventDefault(e),!1;var r=v("<div class='jqx-editor-window jqx-editor-image-window'><div>"+i.localization["Insert Image"]+"</div><div><table style='border-collapse: separate; border-spacing: 2px;'><tr><td align='right'>"+i.localization.URL+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+i.localization["Alt Text"]+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+i.localization.Width+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+i.localization.Height+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+i.localization.HSpace+":</td><td><input style='width: 180px; height: 23px;' class='jqx-editor-hspace'/></td><tr/><tr><td align='right'>"+i.localization.VSpace+":</td><td><input style='width: 180px; height: 23px;' class='jqx-editor-vspace'/></td><tr/><tr><td align='right'>"+i.localization.Align+":</td><td><div class='jqx-editor-align'></div></td><tr/><tr><td align='right'></td><td align='right'><button>Ok</button><button style='margin-left: 5px;'>Remove</button><button style='margin-left: 5px;'>Cancel</button></td><tr/></table></div></div>"),t=(r[0].id="imageWindow"+this.element.id,r.find("input")),o=(t.addClass(i.toThemeProperty("jqx-widget")),t.addClass(i.toThemeProperty("jqx-widget-content")),t.addClass(i.toThemeProperty("jqx-input")),r.find(".jqx-editor-align").jqxDropDownList({hint:!1,autoDropDownHeight:!0,selectedIndex:0,theme:i.theme,height:23,width:180,source:[i.localization["not set"],i.localization.Left,i.localization.Right]}),r.find("button:first").jqxButton({theme:i.theme})),a=r.find("button:last").jqxButton({theme:i.theme}),l=v(r.find("button")[1]).jqxButton({theme:i.theme});return o.val(i.localization.Ok),a.val(i.localization.Cancel),l.val(i.localization.Remove),l.hide(),i.addHandler(l,v.jqx.mobile.isTouchDevice()?v.jqx.mobile.getTouchEventName("touchstart"):"click",function(e){v(i.editImage).removeClass("jqx-editor-focus"),v(i.editImage).remove(),i.editImage=null,i._preventDefault(e),r.jqxWindow("close"),i._raiseEvent("change")}),i.addHandler(a,v.jqx.mobile.isTouchDevice()?v.jqx.mobile.getTouchEventName("touchstart"):"click",function(e){v(i.editImage).removeClass("jqx-editor-focus"),i.editImage=null,i._preventDefault(e)}),i.addHandler(o,v.jqx.mobile.isTouchDevice()?v.jqx.mobile.getTouchEventName("touchstart"):"click",function(e){v(i.editImage).removeClass("jqx-editor-focus");var t=r.find("input"),o=(i.editImage?v(i.editImage):v('<img style="border: 1px solid transparent;">')).attr("src",t[0].value).attr("unselectable","on"),t=(t[1].value&&o.attr("alt",t[1].value).attr("title",t[1].value),t[2].value&&!isNaN(parseInt(t[2].value))?o.width(t[2].value):o.css("width","auto"),t[3].value&&!isNaN(parseInt(t[3].value))?o.height(t[3].value):o.css("height","auto"),t[4].value?"auto"==t[4].value.toString()?(o.css("margin-left","auto"),o.css("margin-right","auto")):-1!=t[4].value.toString().indexOf("%")?(o.css("margin-left",parseInt(t[4].value)+"%"),o.css("margin-right",parseInt(t[4].value)+"%")):(o.css("margin-left",parseInt(t[4].value)+"px"),o.css("margin-right",parseInt(t[4].value)+"px")):(o.css("margin-left","0px"),o.css("margin-right","0px")),t[5].value?"auto"==t[5].value.toString()?(o.css("margin-top","auto"),o.css("margin-bottom","auto")):-1!=t[5].value.toString().indexOf("%")?(o.css("margin-top",parseInt(t[5].value)+"%"),o.css("margin-bottom",parseInt(t[5].value)+"%")):(o.css("margin-top",parseInt(t[5].value)+"px"),o.css("margin-bottom",parseInt(t[5].value)+"px")):(o.css("margin-top","0px"),o.css("margin-bottom","0px")),r.find(".jqx-editor-align").jqxDropDownList("selectedIndex"));1==t?o.css("float","left"):2==t?o.css("float","right"):0==t&&o.css("float","none"),o.css("resize",!1),o[0].oncontrolselect=function(){return!1},o[0].selectstart=function(){return!1},i.editImage||(i.focused||i.editor.focus(),i.range&&i.selectRange(i.range),i.execute("insertHTML",o[0].outerHTML+"<span id='INSERTION_MARKER'>&nbsp;</span>",n),i.editor.focus(),t=v(i.editorDocument).find("#INSERTION_MARKER"),i.selection.selectNode(t[0],!0),i.getRange().setStartAfter&&i.getRange().setStartAfter(t[0]),t.remove(),i.selection.collapse(!1),i._refreshTools(),i._preventDefault(e)),i.editImage=null,i._preventDefault(e)}),r.appendTo(document.body),i.updating=!0,i.addHandler(r,"open",function(){i.updating=!0,setTimeout(function(){i.range=i.getRange(),v(t[0]).focus()},25)}),r.jqxWindow({resizable:!1,width:280,okButton:o,cancelButton:a,theme:i.theme,isModal:!0,position:{center:i.widget}}),i.addHandler(r,"close",function(){i.updating=!1}),i.focused||(i.editor.focus(),i.selectRange(i.range)),i._preventDefault(e),!1}i._preventDefault(e)},editmode:function(e){var t,o,i=this;e||i.readOnly?e&&i.readOnly&&(t=i.editor.find("#sourceText").text(),i.editor.html(t),i.buttons.hasOwnProperty("html")&&i.buttons.html.removeClass("active"),i.editor.attr("contentEditable",!0),i._addHandlers()):(i._removeHandlers(),i.editor.attr("contentEditable",!1),t=document.createTextNode(i.editor.html()),(o=v("<pre>")).html(t).attr({id:"sourceText",contentEditable:!0}).css("height","100%"),i.editor.html(o),i.buttons.hasOwnProperty("html")&&i.buttons.html.addClass("active"),o.focus()),i.readOnly=!e},setMode:function(e){var t,o,i=this,n=(i.range||(i.editor.focus(),i.range=i.getRange()),i.editor[0]);e?(i._documentMode="source",o=(t=new r).HTMLtoXML(n.innerHTML),o=t.FormatHTML(o),t=document.createTextNode(o),n.innerHTML="",o=document.createElement("pre"),n.contentEditable=!1,o.style.height="100%",o.style.margin="0px",o.style.outline="none",o.style.display="block",o.id="sourceText",o.contentEditable=!0,o.appendChild(t),n.appendChild(o),this.readOnly=!0):(this._documentMode="html",document.all?n.innerHTML=n.innerText:n.textContent?n.innerHTML=n.textContent:((t=document.createRange()).selectNodeContents(n.firstChild),n.innerHTML=t.toString()),n.contentEditable=!0,i.readOnly=!1,i._refreshTools(),i.editor.focus(),i.selection.selectNode(i.editor[0]),i.editor.scrollTop(0),i.selection.collapse(!0)),v.each(this.commands,function(){if(this.widget&&"viewsource"!=this.command)switch(this.type){case"list":this.widget.jqxDropDownList({disabled:e});break;case"colorPicker":this.widget.jqxDropDownButton({disabled:e});break;case"button":this.widget.jqxButton({disabled:e});break;case"toggleButton":this.widget.jqxToggleButton({toggled:!1,disabled:e})}}),i.editor.focus(),v.jqx.browser.mozilla&&(o=v("<a href='#'>anchor</a>"),i.editor.prepend(o),o.focus(),o.remove(),i.selection.collapse(!0)),i.commands.html.widget&&(i.commands.html.widget.jqxToggleButton({toggled:"source"==e||1==e}),i.commands.html.toggled="source"==e||1==e)},execute:function(t,o,e){var i=this;if(!i.readOnly){var n=i.editorDocument;if("source"!=i._documentMode){i.changeType="mouse",i.linkPopup&&i.linkPopup.remove(),i.editor.focus(),v.jqx.browser.mozilla,v.jqx.mobile.isTouchDevice()&&setTimeout(function(){},25);function r(e){try{if(e.command&&"inserthtml"==e.command.toLowerCase()){var t=i.getRange(),o=e.value;-1==o.toString().indexOf("<")&&(o="<span>"+e.value+"</span>"),i.selection.insertContent(o+"<span id='INSERTION_MARKER'>&nbsp;</span>"),i.selectRange(t),setTimeout(function(){var e=v(i.editorDocument).find("#INSERTION_MARKER");i.selection.selectNode(v(e).prev()[0],!0),e.remove(),i.selection.collapse(!1)},10)}else if(e.command){if(!n.queryCommandEnabled(e.command))return!1;n.execCommand(e.command,!1,e.value)}else{if(!n.queryCommandEnabled(e))return!1;n.execCommand(e,!1,e)}}catch(e){}}var a;if("custom"==t)(a=o.action(o.widget,i.editor))&&r(a);else try{if(e&&e.action)r(a=e.action(e.widget,i.editor));else if(n.queryCommandEnabled(t))n.execCommand(t,!1,o);else{if("insertHTML"!=t)return!1;i.selection.insertContent(o)}}catch(e){if("insertHTML"!=t)return!1;i.selection.insertContent(o)}v.jqx.mobile.isTouchDevice()&&setTimeout(function(){i.iframe&&i.iframe[0].contentWindow.focus()},500),i._raiseEvent("change",{command:t,args:o}),i.changed=!0,i.range=i.getRange()}}},destroy:function(){function e(e){v.each(e,function(e,t){var o=i.commands[this];if(!o)return!0;switch(o.type){case"list":o.widget.jqxDropDownList("destroy");break;case"colorPicker":o.colorPicker.remove(),o.widget.jqxDropDownButton("destroy");break;case"toggleButton":o.widget.jqxToggleButton("destroy");break;case"custom":i.destroyTool&&i.destroyTool(this);break;default:o.widget.jqxToggleButton("destroy"),"insertimage"===o.command?0<v("#imageWindow"+i.element.id).length&&(v("#imageWindow"+i.element.id).find(".jqx-editor-align").jqxDropDownList("destroy"),v("#imageWindow"+i.element.id).find("button").jqxButton("destroy")):"createlink"===o.command&&0<v("#linkWindow"+i.element.id).length&&(v("#linkWindow"+i.element.id).find(".jqx-editor-align").jqxDropDownList("destroy"),v("#linkWindow"+i.element.id).find("button").jqxButton("destroy"),v("#linkWindow"+i.element.id).find(".jqx-editor-link-checkbox").jqxCheckBox("destroy"))}})}var i=this,t=(i._removeHandlers(),i.tools.split(" ")),o=i.tools.split(" | ");v.jqx.utilities.resize(this.host,null,!0);if(0==o.length)e(t);else for(var n=0;n<o.length;n++)e(t=o[n].split(" "));var r=v("#linkWindow"+this.element.id),a=v("#imageWindow"+this.element.id);r&&0<r.length&&r.jqxWindow("destroy"),a&&0<a.length&&a.jqxWindow("destroy"),i.inline?i.toolbar.remove():(i.widget.remove(),i.host.remove()),i.iframe.remove(),i.iframe=null,i.selection=null,i.editorDocument=null,i.contentEditableElement=null},val:function(e){var t,o;return void 0!==e&&"source"===e?(o=this.editor[0],"source"===this._documentMode&&(o=this.editor.find("pre:first")[0]),o=(t=new r).HTMLtoXML(o.innerHTML),t.FormatHTML(o)):(null!=e&&"object"!=typeof e&&this.editor.html(e),("source"===this._documentMode?this.editor.find("pre:first"):this.editor).html())},_raiseEvent:function(e,t){if("source"==this._documentMode)return!0;(t=null==t?{owner:null}:t).type=this.changeType,this.changeType=null;var o=t,e=(o.owner=this,new v.Event(e));return e.owner=this,e.args=o,o=(this._textArea?v(this._textArea):this.host).trigger(e),t=e.args,o}});var d=function(o){var e={initialize:function(e){this.document=e},getSelection:function(){return this.document.getSelection?this.document.getSelection():this.document.selection},getRange:function(){var e=this.getSelection();if(!e)return null;try{return 0<e.rangeCount?e.getRangeAt(0):(this.document.createRange?this.document:this.document.selection).createRange()}catch(e){return this.document.body.createTextRange()}},selectRange:function(e){var t;e.select?e.select():(t=this.getSelection()).addRange&&(t.removeAllRanges(),t.addRange(e))},selectNode:function(e,t){var o=this.getRange(),i=this.getSelection();if(o.moveToElementText)o.moveToElementText(e),o.select();else if(i.addRange)try{t?o.selectNodeContents(e):o.selectNode(e),i.removeAllRanges(),i.addRange(o)}catch(e){}else i.setBaseAndExtent(e,0,e,1);return e},isCollapsed:function(){var e=this.getRange();return!e.item&&(0==e.boundingWidth||this.getSelection().isCollapsed)},collapse:function(e){var t=this.getRange(),o=this.getSelection();t.select?(t.collapse(e),t.select()):e?o.collapseToStart():o.collapseToEnd()},getContent:function(){var e=this.getRange(),t=v("<div>")[0];return this.isCollapsed()?"":(e.cloneContents?t.appendChild(e.cloneContents()):null!=e.item||null!=e.htmlText?v(t).html(e.item?e.item(0).outerHTML:e.htmlText):v(t).html(e.toString()),v(t).html())},getText:function(){var e=this.getRange(),t=this.getSelection();return this.isCollapsed()?"":e.text||(t.toString?t.toString():"")},getNode:function(){var e=this.getRange();if(!v.jqx.browser.msie||9<=v.jqx.browser.version){var t=null;if(e)for(t=e.commonAncestorContainer,e.collapsed||e.startContainer==e.endContainer&&e.startOffset-e.endOffset<2&&e.startContainer.hasChildNodes()&&(t=e.startContainer.childNodes[e.startOffset]);"element"!=typeof t;)t=t.parentNode;return o.id(t)}return o.id(e.item?e.item(0):e.parentElement())},insertContent:function(e){var t,o,i=this.getRange();i.pasteHTML?(i.pasteHTML(e),i.collapse(!1),i.select()):i.insertNode&&(i.deleteContents(),i.createContextualFragment?i.insertNode(i.createContextualFragment(e)):(t=(o=this.document).createDocumentFragment(),o=o.createElement("div"),t.appendChild(o),o.outerHTML=e,i.insertNode(t)))}};return e.initialize(o),e},r=function(){var d=/^<([-A-Za-z0-9_]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,s=/^<\/([-A-Za-z0-9_]+)[^>]*>/,c=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,u=e("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),g=e("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),p=e("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),h=e("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),m=e("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),f=e("script,style"),t=this.HTMLParser=function(e,r){var t,a=[];for(a.last=function(){return this[this.length-1]};e;){var o,i=!0;a.last()&&f[a.last()]?(e=e.replace(new RegExp("(.*)</"+a.last()+"[^>]*>"),function(e,t){return t=t.replace(/<!--(.*?)-->/g,"$1").replace(/<!\[CDATA\[(.*?)]]>/g,"$1"),r.chars&&r.chars(t),""}),l(0,a.last())):(0==e.indexOf("\x3c!--")?0<=(o=e.indexOf("--\x3e"))&&(r.comment&&r.comment(e.substring(4,o)),e=e.substring(o+3),i=!1):0==e.indexOf("</")?(t=e.match(s))&&(e=e.substring(t[0].length),t[0].replace(s,l),i=!1):0==e.indexOf("<")&&(t=e.match(d))&&(e=e.substring(t[0].length),t[0].replace(d,n),i=!1),i&&(i=(o=e.indexOf("<"))<0?e:e.substring(0,o),e=o<0?"":e.substring(o),r.chars&&r.chars(i))),0}function n(e,t,o,i){if(t=t.toLowerCase(),g[t])for(;a.last()&&p[a.last()];)l(0,a.last());var n;h[t]&&a.last()==t&&l(0,t),(i=u[t]||!!i)||a.push(t),r.start&&(n=[],o.replace(c,function(e,t){var o=arguments[2]||arguments[3]||arguments[4]||(m[t]?t:"");n.push({name:t,value:o,escaped:o.replace(/(^|[^\\])"/g,'$1\\"')})}),r.start&&r.start(t,n,i))}function l(e,t){if(t)for(o=a.length-1;0<=o&&a[o].toLowerCase()!=t.toLowerCase();o--);else var o=0;if(0<=o){for(var i=a.length-1;o<=i;i--)r.end&&r.end(a[i]);a.length=o}}l()};function e(e){for(var t={},o=e.split(","),i=0;i<o.length;i++)t[o[i]]=!0;return t}this.HTMLtoXML=function(e){var n="";return e=(e=e.replace(/\r/gi,"")).replace(/\n/gi,""),t(e,{start:function(e,t,o){n+="<"+e;for(var i=0;i<t.length;i++)n+=" "+t[i].name+'="'+t[i].escaped+'"';n+=(o?"/":"")+">"},end:function(e){n+="</"+e+">\r\n"},chars:function(e){n+=e},comment:function(e){n+="\x3c!--"+e+"--\x3e"}}),n},this.FormatHTML=function(e,t){var o,i,n,r,d;for(i=(t=t||{}).indent_size||4,n=t.indent_char||" ",r=t.brace_style||"collapse",d=t.unformatted||["a","span","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","pre","address","dt","h1","h2","h3","h4","h5","h6"],(o=new function(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.Utils={whitespace:"\n\r\t ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed,?php,?,?=".split(","),extra_liners:"head,body,/html".split(","),in_array:function(e,t){for(var o=0;o<t.length;o++)if(e===t[o])return!0;return!1}},this.get_content=function(){for(var e,t=[],o=!1;"<"!==this.input.charAt(this.pos);){if(this.pos>=this.input.length)return t.length?t.join(""):["","TK_EOF"];if(e=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(e,this.Utils.whitespace))t.length&&(o=!0),this.line_char_count--;else{if(o){if(this.line_char_count>=this.max_char){t.push("\n");for(var i=0;i<this.indent_level;i++)t.push(this.indent_string);this.line_char_count=0}else t.push(" "),this.line_char_count++;o=!1}t.push(e)}}return t.length?t.join(""):""},this.get_contents_to=function(e){if(this.pos==this.input.length)return["","TK_EOF"];var t="",e=new RegExp("</"+e+"\\s*>","igm"),e=(e.lastIndex=this.pos,e.exec(this.input)),e=e?e.index:this.input.length;return this.pos<e&&(t=this.input.substring(this.pos,e),this.pos=e),t},this.record_tag=function(e){this.tags[e+"count"]?this.tags[e+"count"]++:this.tags[e+"count"]=1,this.tags[e+this.tags[e+"count"]]=this.indent_level,this.tags[e+this.tags[e+"count"]+"parent"]=this.tags.parent,this.tags.parent=e+this.tags[e+"count"]},this.retrieve_tag=function(e){if(this.tags[e+"count"]){for(var t=this.tags.parent;t&&e+this.tags[e+"count"]!==t;)t=this.tags[t+"parent"];t&&(this.indent_level=this.tags[e+this.tags[e+"count"]],this.tags.parent=this.tags[t+"parent"]),delete this.tags[e+this.tags[e+"count"]+"parent"],delete this.tags[e+this.tags[e+"count"]],1==this.tags[e+"count"]?delete this.tags[e+"count"]:this.tags[e+"count"]--}},this.get_tag=function(){var e,t,o="",i=[],n=!1;do{if(this.pos>=this.input.length)return i.length?i.join(""):["","TK_EOF"]}while(o=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(o,this.Utils.whitespace)?(n=!0,this.line_char_count--):("'"!==o&&'"'!==o||i[1]&&"!"===i[1]||(o+=this.get_unformatted(o),n=!0),"="===o&&(n=!1),i.length&&"="!==i[i.length-1]&&">"!==o&&n&&(this.line_char_count>=this.max_char?(this.print_newline(!1,i),this.line_char_count=0):(i.push(" "),this.line_char_count++),n=!1),"<"===o&&(e=this.pos-1),i.push(o)),">"!==o);var r,a=i.join(""),l=-1!=a.indexOf(" ")?a.indexOf(" "):a.indexOf(">"),l=a.substring(1,l).toLowerCase();return"/"===a.charAt(a.length-2)||this.Utils.in_array(l,this.Utils.single_token)?this.tag_type="SINGLE":"script"===l?(this.record_tag(l),this.tag_type="SCRIPT"):"style"===l?(this.record_tag(l),this.tag_type="STYLE"):this.Utils.in_array(l,d)?(r=this.get_unformatted("</"+l+">",a),i.push(r),0<e&&this.Utils.in_array(this.input.charAt(e-1),this.Utils.whitespace)&&i.splice(0,0,this.input.charAt(e-1)),t=this.pos-1,this.Utils.in_array(this.input.charAt(1+t),this.Utils.whitespace)&&i.push(this.input.charAt(1+t)),this.tag_type="SINGLE"):"!"===l.charAt(0)?-1!=l.indexOf("[if")?(-1!=a.indexOf("!IE")&&(r=this.get_unformatted("--\x3e",a),i.push(r)),this.tag_type="START"):-1!=l.indexOf("[endif")?(this.tag_type="END",this.unindent()):(r=-1!=l.indexOf("[cdata[")?this.get_unformatted("]]>",a):this.get_unformatted("--\x3e",a),i.push(r),this.tag_type="SINGLE"):("/"===l.charAt(0)?(this.retrieve_tag(l.substring(1)),this.tag_type="END"):(this.record_tag(l),this.tag_type="START"),this.Utils.in_array(l,this.Utils.extra_liners)&&this.print_newline(!0,this.output)),i.join("")},this.get_unformatted=function(e,t){if(t&&-1!=t.indexOf(e))return"";var o,i="",n=!0;do{if(this.pos>=this.input.length)return i;if(o=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(o,this.Utils.whitespace)){if(!n){this.line_char_count--;continue}if("\n"===o||"\r"===o){i+="\n",this.line_char_count=0;continue}}i+=o,this.line_char_count++,n=!0}while(-1==i.indexOf(e));return i},this.get_token=function(){var e,t;return"TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token?(e=this.last_token.substr(7),"string"!=typeof(t=this.get_contents_to(e))?t:[t,"TK_"+e]):"CONTENT"===this.current_mode?"string"!=typeof(t=this.get_content())?t:[t,"TK_CONTENT"]:"TAG"===this.current_mode?"string"!=typeof(t=this.get_tag())?t:[t,"TK_TAG_"+this.tag_type]:void 0},this.get_full_indent=function(e){return(e=this.indent_level+e||0)<1?"":Array(e+1).join(this.indent_string)},this.printer=function(e,t,o,i,n){this.input=e||"",this.output=[],this.indent_character=t,this.indent_string="",this.indent_size=o,this.brace_style=n,this.indent_level=0,this.max_char=i;for(var r=this.line_char_count=0;r<this.indent_size;r++)this.indent_string+=this.indent_character;this.print_newline=function(e,t){if(this.line_char_count=0,t&&t.length){if(!e)for(;this.Utils.in_array(t[t.length-1],this.Utils.whitespace);)t.pop();t.push("\n");for(var o=0;o<this.indent_level;o++)t.push(this.indent_string)}},this.print_token=function(e){this.output.push(e)},this.indent=function(){this.indent_level++},this.unindent=function(){0<this.indent_level&&this.indent_level--}},this}).printer(e,n,i,1/0,r);;){var a,l,s,c,u=o.get_token();if(o.token_text=u[0],o.token_type=u[1],"TK_EOF"===o.token_type)break;switch(o.token_type){case"TK_TAG_START":o.print_newline(!1,o.output),o.print_token(o.token_text),o.indent(),o.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":o.print_newline(!1,o.output),o.print_token(o.token_text),o.current_mode="CONTENT";break;case"TK_TAG_END":"TK_CONTENT"===o.last_token&&""===o.last_text&&(c=o.token_text.match(/\w+/)[0],null!==(g=o.output[o.output.length-1].match(/<\s*(\w+)/))&&g[1]===c||o.print_newline(!0,o.output)),o.print_token(o.token_text),o.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var g=o.token_text.match(/^\s*<([a-z]+)/i);g&&o.Utils.in_array(g[1],d)||o.print_newline(!1,o.output),o.print_token(o.token_text),o.current_mode="CONTENT";break;case"TK_CONTENT":""!==o.token_text&&o.print_token(o.token_text),o.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":""!==o.token_text&&(o.output.push("\n"),c=o.token_text,s="keep"==t.indent_scripts?0:"separate"==t.indent_scripts?-o.indent_level:1,a=o.get_full_indent(s),l=c.match(/^\s*/)[0].match(/[^\n\r]*$/)[0].split(o.indent_string).length-1,s=o.get_full_indent(s-l),(c=c.replace(/^\s*/,a).replace(/\r\n|\r|\n/g,"\n"+s).replace(/\s*$/,""))&&(o.print_token(c),o.print_newline(!0,o.output))),o.current_mode="TAG"}o.last_token=o.token_type,o.last_text=o.token_text}return o.output.join("")}}}(jqxBaseFramework);